2025-11-05 00:50:25.552 IST [54409] @ LOG:  checkpoint complete: wrote 6 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.718 s, sync=0.005 s, total=0.861 s; sync files=6, longest=0.003 s, average=0.001 s; distance=13 kB, estimate=350 kB; lsn=0/5CE2F290, redo lsn=0/5CE2F258
2025-11-05 10:38:39.339 IST [73765] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=62588
2025-11-05 10:38:39.343 IST [73765] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 10:38:39.387 IST [73765] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.048 user=jagdish_pandre database=postgres host=127.0.0.1 port=62588
2025-11-05 10:38:39.390 IST [73766] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=62589
2025-11-05 10:38:39.394 IST [73766] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 10:38:39.466 IST [73767] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=62590
2025-11-05 10:38:39.469 IST [73767] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 10:38:39.561 IST [73768] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=62591
2025-11-05 10:38:39.563 IST [73768] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 10:38:39.602 IST [73769] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=62592
2025-11-05 10:38:39.604 IST [73769] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 10:38:39.736 IST [73770] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=62593
2025-11-05 10:38:39.738 IST [73770] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 10:39:45.871 IST [73861] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=62633
2025-11-05 10:39:45.874 IST [73861] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 10:41:24.199 IST [73768] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:02:44.638 user=jagdish_pandre database=fake_db host=127.0.0.1 port=62591
2025-11-05 10:41:24.215 IST [73769] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:02:44.612 user=jagdish_pandre database=fake_db host=127.0.0.1 port=62592
2025-11-05 10:41:24.230 IST [73770] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:02:44.493 user=jagdish_pandre database=fake_db host=127.0.0.1 port=62593
2025-11-05 10:41:24.245 IST [73861] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:01:38.373 user=jagdish_pandre database=fake_db host=127.0.0.1 port=62633
2025-11-05 10:41:24.256 IST [73766] jagdish_pandre@postgres LOG:  disconnection: session time: 0:02:44.865 user=jagdish_pandre database=postgres host=127.0.0.1 port=62589
2025-11-05 10:41:24.271 IST [73767] jagdish_pandre@postgres LOG:  disconnection: session time: 0:02:44.804 user=jagdish_pandre database=postgres host=127.0.0.1 port=62590
2025-11-05 11:25:43.787 IST [76582] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64263
2025-11-05 11:25:43.788 IST [76582] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 11:25:43.821 IST [76582] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.034 user=jagdish_pandre database=postgres host=127.0.0.1 port=64263
2025-11-05 11:25:43.824 IST [76583] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64264
2025-11-05 11:25:43.828 IST [76583] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 11:25:43.887 IST [76584] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64265
2025-11-05 11:25:43.891 IST [76584] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 11:25:43.988 IST [76585] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64266
2025-11-05 11:25:43.991 IST [76585] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 11:25:44.001 IST [76586] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64267
2025-11-05 11:25:44.004 IST [76586] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 11:25:44.044 IST [76587] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64268
2025-11-05 11:25:44.047 IST [76587] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 11:25:44.082 IST [76588] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64269
2025-11-05 11:25:44.085 IST [76588] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 11:25:49.404 IST [76595] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64270
2025-11-05 11:25:49.407 IST [76595] jagdish_pandre@pdcd_db LOG:  connection authorized: user=jagdish_pandre database=pdcd_db
2025-11-05 11:25:49.467 IST [76596] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64271
2025-11-05 11:25:49.471 IST [76596] jagdish_pandre@pdcd_db LOG:  connection authorized: user=jagdish_pandre database=pdcd_db
2025-11-05 11:30:44.776 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 11:30:46.077 IST [54409] @ LOG:  checkpoint complete: wrote 12 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.269 s, sync=0.002 s, total=1.302 s; sync files=10, longest=0.001 s, average=0.001 s; distance=8 kB, estimate=316 kB; lsn=0/5CE31620, redo lsn=0/5CE315E8
2025-11-05 11:55:49.914 IST [76585] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:30:05.926 user=jagdish_pandre database=fake_db host=127.0.0.1 port=64266
2025-11-05 11:55:49.930 IST [76586] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:30:05.929 user=jagdish_pandre database=fake_db host=127.0.0.1 port=64267
2025-11-05 11:55:49.941 IST [76587] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:30:05.897 user=jagdish_pandre database=fake_db host=127.0.0.1 port=64268
2025-11-05 11:55:49.956 IST [76588] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:30:05.874 user=jagdish_pandre database=fake_db host=127.0.0.1 port=64269
2025-11-05 11:55:49.972 IST [76595] jagdish_pandre@pdcd_db LOG:  disconnection: session time: 0:30:00.567 user=jagdish_pandre database=pdcd_db host=127.0.0.1 port=64270
2025-11-05 11:55:49.988 IST [76596] jagdish_pandre@pdcd_db LOG:  disconnection: session time: 0:30:00.520 user=jagdish_pandre database=pdcd_db host=127.0.0.1 port=64271
2025-11-05 11:55:50.003 IST [76583] jagdish_pandre@postgres LOG:  disconnection: session time: 0:30:06.179 user=jagdish_pandre database=postgres host=127.0.0.1 port=64264
2025-11-05 11:55:50.017 IST [76584] jagdish_pandre@postgres LOG:  disconnection: session time: 0:30:06.130 user=jagdish_pandre database=postgres host=127.0.0.1 port=64265
2025-11-05 13:13:27.534 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.audit_md5_metadata;
2025-11-05 13:13:27.538 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near "PRIMARY" at character 75
2025-11-05 13:13:27.538 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE TABLE IF NOT EXISTS pdcd_schema.audit_md5_metadata (
	  metadata_id PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,          -- TABLE, VIEW, FUNCTION, ...
	  object_type_name TEXT NOT NULL,     -- table/view name
	  object_subtype TEXT,                -- Column, Index, Trigger, ...
	  object_subtype_name TEXT,           -- column name or index name
	  object_subtype_details TEXT,        -- raw detail string
	  object_md5 TEXT NOT NULL,           -- md5 fingerprint of the object_subtype_details (or full row)
	  processed_time TIMESTAMP DEFAULT clock_timestamp(),
	  change_type TEXT,   -- ADDED | MODIFIED | UNCHANGED | DELETED (we'll use ADDED/MODIFIED/DELETED on insert)
	--   prev_object_md5 TEXT                -- store previous md5 for reference (NULL for new)
	);
2025-11-05 13:13:42.572 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.audit_md5_metadata;
2025-11-05 13:13:42.575 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near ")" at character 893
2025-11-05 13:13:42.575 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE TABLE IF NOT EXISTS pdcd_schema.audit_md5_metadata (
	  metadata_id TEXT PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,          -- TABLE, VIEW, FUNCTION, ...
	  object_type_name TEXT NOT NULL,     -- table/view name
	  object_subtype TEXT,                -- Column, Index, Trigger, ...
	  object_subtype_name TEXT,           -- column name or index name
	  object_subtype_details TEXT,        -- raw detail string
	  object_md5 TEXT NOT NULL,           -- md5 fingerprint of the object_subtype_details (or full row)
	  processed_time TIMESTAMP DEFAULT clock_timestamp(),
	  change_type TEXT,   -- ADDED | MODIFIED | UNCHANGED | DELETED (we'll use ADDED/MODIFIED/DELETED on insert)
	--   prev_object_md5 TEXT                -- store previous md5 for reference (NULL for new)
	);
2025-11-05 13:13:55.664 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.audit_md5_metadata;
2025-11-05 13:13:55.665 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE IF NOT EXISTS pdcd_schema.audit_md5_metadata (
	  metadata_id TEXT PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,          -- TABLE, VIEW, FUNCTION, ...
	  object_type_name TEXT NOT NULL,     -- table/view name
	  object_subtype TEXT,                -- Column, Index, Trigger, ...
	  object_subtype_name TEXT,           -- column name or index name
	  object_subtype_details TEXT,        -- raw detail string
	  object_md5 TEXT NOT NULL,           -- md5 fingerprint of the object_subtype_details (or full row)
	  processed_time TIMESTAMP DEFAULT clock_timestamp(),
	  change_type TEXT   -- ADDED | MODIFIED | UNCHANGED | DELETED (we'll use ADDED/MODIFIED/DELETED on insert)
	--   prev_object_md5 TEXT                -- store previous md5 for reference (NULL for new)
	);
2025-11-05 13:16:09.920 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 13:16:13.907 IST [54409] @ LOG:  checkpoint complete: wrote 39 buffers (0.2%); 0 WAL file(s) added, 0 removed, 0 recycled; write=3.941 s, sync=0.021 s, total=3.989 s; sync files=36, longest=0.007 s, average=0.001 s; distance=156 kB, estimate=300 kB; lsn=0/5CE589A0, redo lsn=0/5CE58968
2025-11-05 13:31:15.709 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.audit_md5_metadata;
2025-11-05 13:33:37.108 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.audit_md5_metadata_tbl;
2025-11-05 13:33:37.109 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE IF NOT EXISTS pdcd_schema.audit_md5_metadata_tbl (
	  metadata_id TEXT PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,          -- TABLE, VIEW, FUNCTION, ...
	  object_type_name TEXT NOT NULL,     -- table/view name
	  object_subtype TEXT,                -- Column, Index, Trigger, ...
	  object_subtype_name TEXT,           -- column name or index name
	  object_subtype_details TEXT,        -- raw detail string
	  object_md5 TEXT NOT NULL,           -- md5 fingerprint of the object_subtype_details (or full row)
	  processed_time TIMESTAMP DEFAULT clock_timestamp(),
	  change_type TEXT   -- ADDED | MODIFIED | UNCHANGED | DELETED (we'll use ADDED/MODIFIED/DELETED on insert)
	--   prev_object_md5 TEXT                -- store previous md5 for reference (NULL for new)
	);
2025-11-05 13:36:09.910 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 13:36:14.935 IST [54409] @ LOG:  checkpoint complete: wrote 49 buffers (0.3%); 0 WAL file(s) added, 0 removed, 0 recycled; write=4.966 s, sync=0.024 s, total=5.026 s; sync files=40, longest=0.007 s, average=0.001 s; distance=225 kB, estimate=292 kB; lsn=0/5CE90EA8, redo lsn=0/5CE90E70
2025-11-05 14:57:49.452 IST [52582] jagdish_pandre@test_db LOG:  statement: ALTER TABLE pdcd_schema.md5_metadata_table
	DROP COLUMN IF EXISTS prev_object_md5;
2025-11-05 14:57:49.452 IST [52582] jagdish_pandre@test_db ERROR:  relation "pdcd_schema.md5_metadata_table" does not exist
2025-11-05 14:57:49.452 IST [52582] jagdish_pandre@test_db STATEMENT:  ALTER TABLE pdcd_schema.md5_metadata_table
	DROP COLUMN IF EXISTS prev_object_md5;
2025-11-05 15:10:31.002 IST [89186] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58243
2025-11-05 15:10:31.008 IST [89186] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 15:10:31.040 IST [89186] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.037 user=jagdish_pandre database=postgres host=127.0.0.1 port=58243
2025-11-05 15:10:31.042 IST [89187] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58244
2025-11-05 15:10:31.045 IST [89187] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 15:10:31.074 IST [89189] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58245
2025-11-05 15:10:31.079 IST [89189] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 15:10:31.142 IST [89190] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58246
2025-11-05 15:10:31.145 IST [89190] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 15:10:31.155 IST [89191] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58247
2025-11-05 15:10:31.157 IST [89191] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 15:10:31.192 IST [89192] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58248
2025-11-05 15:10:31.195 IST [89192] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 15:10:31.254 IST [89193] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58249
2025-11-05 15:10:31.256 IST [89193] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 15:10:39.045 IST [89202] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58250
2025-11-05 15:10:39.050 IST [89202] jagdish_pandre@pdcd_db LOG:  connection authorized: user=jagdish_pandre database=pdcd_db
2025-11-05 15:10:39.081 IST [89203] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58251
2025-11-05 15:10:39.083 IST [89203] jagdish_pandre@pdcd_db LOG:  connection authorized: user=jagdish_pandre database=pdcd_db
2025-11-05 15:11:23.222 IST [89193] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:00:51.968 user=jagdish_pandre database=fake_db host=127.0.0.1 port=58249
2025-11-05 15:11:23.916 IST [89190] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:00:52.773 user=jagdish_pandre database=fake_db host=127.0.0.1 port=58246
2025-11-05 15:11:23.953 IST [89261] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58267
2025-11-05 15:11:23.956 IST [89261] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 15:11:24.932 IST [89261] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:00:00.979 user=jagdish_pandre database=fake_db host=127.0.0.1 port=58267
2025-11-05 15:11:24.966 IST [89263] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58269
2025-11-05 15:11:24.970 IST [89263] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 15:11:25.790 IST [89263] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:00:00.823 user=jagdish_pandre database=fake_db host=127.0.0.1 port=58269
2025-11-05 15:11:25.835 IST [89265] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58270
2025-11-05 15:11:25.838 IST [89265] jagdish_pandre@fake_db LOG:  connection authorized: user=jagdish_pandre database=fake_db
2025-11-05 15:11:26.444 IST [89265] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:00:00.609 user=jagdish_pandre database=fake_db host=127.0.0.1 port=58270
2025-11-05 15:12:55.123 IST [89371] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58311
2025-11-05 15:12:55.126 IST [89371] jagdish_pandre@pdcd_db LOG:  connection authorized: user=jagdish_pandre database=pdcd_db
2025-11-05 15:13:27.410 IST [89424] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58337
2025-11-05 15:13:27.413 IST [89424] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 15:13:27.453 IST [89425] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58338
2025-11-05 15:13:27.457 IST [89425] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 15:13:38.174 IST [89371] jagdish_pandre@pdcd_db LOG:  disconnection: session time: 0:00:43.050 user=jagdish_pandre database=pdcd_db host=127.0.0.1 port=58311
2025-11-05 15:13:38.189 IST [89444] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58347
2025-11-05 15:13:38.191 IST [89444] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 15:13:43.769 IST [89451] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58358
2025-11-05 15:13:43.772 IST [89451] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 15:13:45.390 IST [89451] jagdish_pandre@test_db LOG:  disconnection: session time: 0:00:01.621 user=jagdish_pandre database=test_db host=127.0.0.1 port=58358
2025-11-05 15:13:47.148 IST [89444] jagdish_pandre@test_db LOG:  disconnection: session time: 0:00:08.958 user=jagdish_pandre database=test_db host=127.0.0.1 port=58347
2025-11-05 15:15:16.544 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 15:15:19.466 IST [54409] @ LOG:  checkpoint complete: wrote 28 buffers (0.2%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.899 s, sync=0.003 s, total=2.923 s; sync files=18, longest=0.001 s, average=0.001 s; distance=33 kB, estimate=266 kB; lsn=0/5CE99390, redo lsn=0/5CE99358
2025-11-05 15:17:48.053 IST [52582] jagdish_pandre@test_db LOG:  statement: ALTER TABLE pdcd_schema.md5_metadata_table
	DROP COLUMN IF EXISTS prev_object_md5;
2025-11-05 15:17:48.053 IST [52582] jagdish_pandre@test_db ERROR:  relation "pdcd_schema.md5_metadata_table" does not exist
2025-11-05 15:17:48.053 IST [52582] jagdish_pandre@test_db STATEMENT:  ALTER TABLE pdcd_schema.md5_metadata_table
	DROP COLUMN IF EXISTS prev_object_md5;
2025-11-05 15:19:21.952 IST [52582] jagdish_pandre@test_db LOG:  statement: ALTER TABLE pdcd_schema.md5_metadata_tbl
	DROP COLUMN IF EXISTS prev_object_md5;
2025-11-05 15:19:48.630 IST [52582] jagdish_pandre@test_db LOG:  statement: ALTER TABLE pdcd_schema.md5_metadata_tbl
	DROP COLUMN IF EXISTS change_type;
2025-11-05 15:20:16.505 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 15:20:17.194 IST [54409] @ LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.654 s, sync=0.004 s, total=0.689 s; sync files=7, longest=0.002 s, average=0.001 s; distance=36 kB, estimate=243 kB; lsn=0/5CEA2608, redo lsn=0/5CEA25D0
2025-11-05 15:24:46.604 IST [52582] jagdish_pandre@test_db LOG:  statement: ALTER TABLE pdcd_schema.audit_md5_metadata_tbl
	DROP COLUMN IF EXISTS change_type;
2025-11-05 15:25:16.196 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 15:25:16.957 IST [54409] @ LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.736 s, sync=0.004 s, total=0.762 s; sync files=7, longest=0.003 s, average=0.001 s; distance=17 kB, estimate=221 kB; lsn=0/5CEA6AC8, redo lsn=0/5CEA6A90
2025-11-05 15:26:06.859 IST [52582] jagdish_pandre@test_db LOG:  statement: ALTER TABLE pdcd_schema.md5_metadata_tbl
	ADD COLUMN IF NOT EXISTS change_type TEXT DEFAULT 'ADDED';
2025-11-05 15:30:16.959 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 15:30:18.060 IST [54409] @ LOG:  checkpoint complete: wrote 11 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.067 s, sync=0.004 s, total=1.102 s; sync files=11, longest=0.002 s, average=0.001 s; distance=43 kB, estimate=203 kB; lsn=0/5CEB1A88, redo lsn=0/5CEB1A50
2025-11-05 15:32:43.663 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.load_audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN latest_snapshot ls ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:32:43.666 IST [52582] jagdish_pandre@test_db ERROR:  relation "pdcd_schema.load_audit_md5_metadata_tbl" does not exist at character 911
2025-11-05 15:32:43.666 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.load_audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN latest_snapshot ls ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:33:44.909 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN latest_snapshot ls ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:33:44.911 IST [52582] jagdish_pandre@test_db ERROR:  return type mismatch in function declared to return record
2025-11-05 15:33:44.911 IST [52582] jagdish_pandre@test_db DETAIL:  Final statement returns text instead of bigint at column 1.
2025-11-05 15:33:44.911 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "load_audit_md5_metadata_tbl"
2025-11-05 15:33:44.911 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN latest_snapshot ls ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:34:59.717 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING 
	            metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	            object_subtype, object_subtype_name, object_subtype_details, object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:34:59.718 IST [52582] jagdish_pandre@test_db ERROR:  return type mismatch in function declared to return record
2025-11-05 15:34:59.718 IST [52582] jagdish_pandre@test_db DETAIL:  Final statement returns text instead of bigint at column 1.
2025-11-05 15:34:59.718 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "load_audit_md5_metadata_tbl"
2025-11-05 15:34:59.718 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING 
	            metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	            object_subtype, object_subtype_name, object_subtype_details, object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:35:16.086 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 15:35:16.970 IST [54409] @ LOG:  checkpoint complete: wrote 9 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.851 s, sync=0.005 s, total=0.885 s; sync files=8, longest=0.003 s, average=0.001 s; distance=47 kB, estimate=187 kB; lsn=0/5CEBD6F8, redo lsn=0/5CEBD6C0
2025-11-05 15:38:51.910 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id TEXT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:40:16.973 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 15:40:17.859 IST [54409] @ LOG:  checkpoint complete: wrote 9 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.854 s, sync=0.004 s, total=0.887 s; sync files=9, longest=0.002 s, average=0.001 s; distance=36 kB, estimate=172 kB; lsn=0/5CEC6790, redo lsn=0/5CEC6758
2025-11-05 15:43:08.131 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.audit_md5_metadata_tbl cascade ;
2025-11-05 15:43:15.265 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.md5_metadata_tbl cascade ;
2025-11-05 15:43:23.544 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.snapshot_tbl cascade ;
2025-11-05 15:43:52.376 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near "[" at character 49
2025-11-05 15:43:52.376 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_md5_metadata_tbl([])
	;
2025-11-05 15:44:48.774 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_md5_metadata_tbl(TEXT [])
	;
2025-11-05 15:45:07.833 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_audit_md5_metadata_tbl(TEXT []);
2025-11-05 15:45:16.861 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 15:45:19.272 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.snapshot_tbl;
2025-11-05 15:45:19.280 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE pdcd_schema.snapshot_tbl (
	  snapshot_id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	  snapshot_name TEXT NOT NULL,
	  snapshot_process_time TIMESTAMP DEFAULT clock_timestamp()
	);
2025-11-05 15:45:22.797 IST [54409] @ LOG:  checkpoint complete: wrote 58 buffers (0.4%); 0 WAL file(s) added, 0 removed, 0 recycled; write=5.863 s, sync=0.023 s, total=5.936 s; sync files=28, longest=0.006 s, average=0.001 s; distance=243 kB, estimate=243 kB; lsn=0/5CF29220, redo lsn=0/5CF03680
2025-11-05 15:45:32.568 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.md5_metadata_table;
2025-11-05 15:45:32.569 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE IF NOT EXISTS pdcd_schema.md5_metadata_table (
	  metadata_id BIGSERIAL PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,
	  object_type_name TEXT NOT NULL,
	  object_subtype TEXT,
	  object_subtype_name TEXT,
	  object_subtype_details TEXT,
	  object_md5 TEXT NOT NULL,
	  processed_time TIMESTAMP DEFAULT clock_timestamp(),
	  change_type TEXT DEFAULT 'ADDED'
	);
2025-11-05 15:45:41.644 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.audit_md5_metadata_tbl;
2025-11-05 15:45:41.645 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE IF NOT EXISTS pdcd_schema.audit_md5_metadata_tbl (
	  metadata_id TEXT PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,
	  object_type_name TEXT NOT NULL,
	  object_subtype TEXT,
	  object_subtype_name TEXT,
	  object_subtype_details TEXT,
	  object_md5 TEXT NOT NULL,
	  processed_time TIMESTAMP DEFAULT clock_timestamp()
	);
2025-11-05 15:46:02.548 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        INSERT INTO pdcd_schema.snapshot_tbl (snapshot_name)
	        VALUES (
	            CONCAT_WS('_',
	                'snapshot',
	                COALESCE((SELECT MAX(snapshot_id) FROM pdcd_schema.snapshot_tbl), 0) + 1,
	                TO_CHAR(clock_timestamp(), 'YYYYMMDD_HH24MISS')
	            )
	        )
	        RETURNING snapshot_id, snapshot_process_time AS processed_time
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_table (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, processed_time, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:46:15.748 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id TEXT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 15:47:26.884 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near "(" at character 44
2025-11-05 15:47:26.884 IST [52582] jagdish_pandre@test_db STATEMENT:  select INSERT INTO pdcd_schema.snapshot_tbl(snapshot_name)
	VALUES (
	  'baseline_' || TO_CHAR(CURRENT_DATE, 'YYYYMMDD')
	)
	RETURNING snapshot_id;
2025-11-05 15:50:10.432 IST [52582] jagdish_pandre@test_db ERROR:  function load_audit_md5_metadata_tbl(text[]) does not exist at character 15
2025-11-05 15:50:10.432 IST [52582] jagdish_pandre@test_db HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2025-11-05 15:50:10.432 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT * FROM load_audit_md5_metadata_tbl(ARRAY['companies.employees']);
2025-11-05 15:50:16.704 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 15:50:23.536 IST [54409] @ LOG:  checkpoint complete: wrote 66 buffers (0.4%); 0 WAL file(s) added, 0 removed, 0 recycled; write=6.770 s, sync=0.033 s, total=6.832 s; sync files=53, longest=0.006 s, average=0.001 s; distance=268 kB, estimate=268 kB; lsn=0/5CF46A68, redo lsn=0/5CF46A30
2025-11-05 15:50:26.003 IST [52582] jagdish_pandre@test_db ERROR:  null value in column "metadata_id" of relation "audit_md5_metadata_tbl" violates not-null constraint
2025-11-05 15:50:26.003 IST [52582] jagdish_pandre@test_db DETAIL:  Failing row contains (null, 2, analytics_schema, Table, departments, All_Table_Objects, columns, null, 96af32d12c738e41750e0a8e8274609e, 2025-11-05 15:50:26.002131).
2025-11-05 15:50:26.003 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "load_audit_md5_metadata_tbl" statement 1
2025-11-05 15:50:26.003 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT * FROM pdcd_schema.load_audit_md5_metadata_tbl(ARRAY['analytics_schema']);
2025-11-05 15:53:38.041 IST [89191] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:43:06.886 user=jagdish_pandre database=fake_db host=127.0.0.1 port=58247
2025-11-05 15:53:38.051 IST [89192] jagdish_pandre@fake_db LOG:  disconnection: session time: 0:43:06.859 user=jagdish_pandre database=fake_db host=127.0.0.1 port=58248
2025-11-05 15:53:38.067 IST [89202] jagdish_pandre@pdcd_db LOG:  disconnection: session time: 0:42:59.022 user=jagdish_pandre database=pdcd_db host=127.0.0.1 port=58250
2025-11-05 15:53:38.083 IST [89203] jagdish_pandre@pdcd_db LOG:  disconnection: session time: 0:42:59.001 user=jagdish_pandre database=pdcd_db host=127.0.0.1 port=58251
2025-11-05 15:53:38.098 IST [89187] jagdish_pandre@postgres LOG:  disconnection: session time: 0:43:07.055 user=jagdish_pandre database=postgres host=127.0.0.1 port=58244
2025-11-05 15:53:38.111 IST [89189] jagdish_pandre@postgres LOG:  disconnection: session time: 0:43:07.036 user=jagdish_pandre database=postgres host=127.0.0.1 port=58245
2025-11-05 15:53:38.124 IST [89424] jagdish_pandre@test_db LOG:  disconnection: session time: 0:40:10.714 user=jagdish_pandre database=test_db host=127.0.0.1 port=58337
2025-11-05 15:53:38.134 IST [89425] jagdish_pandre@test_db LOG:  disconnection: session time: 0:40:10.681 user=jagdish_pandre database=test_db host=127.0.0.1 port=58338
2025-11-05 16:04:11.375 IST [93210] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61165
2025-11-05 16:04:11.379 IST [93210] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 16:04:11.393 IST [93210] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.018 user=jagdish_pandre database=postgres host=127.0.0.1 port=61165
2025-11-05 16:04:11.396 IST [93211] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61166
2025-11-05 16:04:11.399 IST [93211] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 16:04:11.436 IST [93212] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61167
2025-11-05 16:04:11.439 IST [93212] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 16:04:15.590 IST [93216] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61169
2025-11-05 16:04:15.594 IST [93216] jagdish_pandre@pdcd_db LOG:  connection authorized: user=jagdish_pandre database=pdcd_db
2025-11-05 16:04:15.625 IST [93218] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61170
2025-11-05 16:04:15.629 IST [93218] jagdish_pandre@pdcd_db LOG:  connection authorized: user=jagdish_pandre database=pdcd_db
2025-11-05 16:04:21.048 IST [93225] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61173
2025-11-05 16:04:21.051 IST [93225] jagdish_pandre@pdcd_db LOG:  connection authorized: user=jagdish_pandre database=pdcd_db
2025-11-05 16:04:44.768 IST [93250] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61174
2025-11-05 16:04:44.772 IST [93250] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 16:04:44.807 IST [93251] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61175
2025-11-05 16:04:44.810 IST [93251] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 16:04:47.548 IST [93225] jagdish_pandre@pdcd_db LOG:  disconnection: session time: 0:00:26.500 user=jagdish_pandre database=pdcd_db host=127.0.0.1 port=61173
2025-11-05 16:04:47.558 IST [93255] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61176
2025-11-05 16:04:47.562 IST [93255] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 16:04:51.389 IST [93255] jagdish_pandre@test_db LOG:  disconnection: session time: 0:00:03.831 user=jagdish_pandre database=test_db host=127.0.0.1 port=61176
2025-11-05 16:04:56.148 IST [93266] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=61179
2025-11-05 16:04:56.150 IST [93266] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 16:26:34.516 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 16:26:34.519 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_snapshot_tbl(text[]) does not exist
2025-11-05 16:26:34.519 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 16:26:34.520 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_md5_metadata_tbl(TEXT[]);
2025-11-05 16:26:34.526 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_audit_md5_metadata_tbl(TEXT[]);
2025-11-05 16:26:56.048 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_snapshot_tbl()
	RETURNS TABLE (
	    snapshot_id INT,
	    snapshot_name TEXT,
	    snapshot_process_time TIMESTAMP
	)
	LANGUAGE SQL
	AS $function$
	    INSERT INTO pdcd_schema.snapshot_tbl (snapshot_name)
	    VALUES (
	        CONCAT_WS('_',
	            'snapshot',
	            COALESCE((SELECT MAX(snapshot_id) FROM pdcd_schema.snapshot_tbl), 0) + 1,
	            TO_CHAR(clock_timestamp(), 'YYYYMMDD_HH24MISS')
	        )
	    )
	    RETURNING snapshot_id, snapshot_name, snapshot_process_time;
	$function$;
2025-11-05 16:27:03.992 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_table (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 16:28:22.748 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 16:28:24.353 IST [54409] @ LOG:  checkpoint complete: wrote 16 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.578 s, sync=0.004 s, total=1.606 s; sync files=11, longest=0.002 s, average=0.001 s; distance=36 kB, estimate=245 kB; lsn=0/5CF4FE60, redo lsn=0/5CF4FE28
2025-11-05 16:31:20.336 IST [93216] jagdish_pandre@pdcd_db LOG:  disconnection: session time: 0:27:04.746 user=jagdish_pandre database=pdcd_db host=127.0.0.1 port=61169
2025-11-05 16:31:20.352 IST [93218] jagdish_pandre@pdcd_db LOG:  disconnection: session time: 0:27:04.727 user=jagdish_pandre database=pdcd_db host=127.0.0.1 port=61170
2025-11-05 16:31:20.380 IST [93211] jagdish_pandre@postgres LOG:  disconnection: session time: 0:27:08.984 user=jagdish_pandre database=postgres host=127.0.0.1 port=61166
2025-11-05 16:31:20.381 IST [93212] jagdish_pandre@postgres LOG:  disconnection: session time: 0:27:08.945 user=jagdish_pandre database=postgres host=127.0.0.1 port=61167
2025-11-05 16:31:20.396 IST [93250] jagdish_pandre@test_db LOG:  disconnection: session time: 0:26:35.628 user=jagdish_pandre database=test_db host=127.0.0.1 port=61174
2025-11-05 16:31:20.412 IST [93251] jagdish_pandre@test_db LOG:  disconnection: session time: 0:26:35.605 user=jagdish_pandre database=test_db host=127.0.0.1 port=61175
2025-11-05 16:31:20.427 IST [93266] jagdish_pandre@test_db LOG:  disconnection: session time: 0:26:24.279 user=jagdish_pandre database=test_db host=127.0.0.1 port=61179
2025-11-05 16:35:26.045 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 16:35:26.417 IST [54409] @ LOG:  checkpoint complete: wrote 4 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.329 s, sync=0.004 s, total=0.373 s; sync files=4, longest=0.003 s, average=0.001 s; distance=0 kB, estimate=221 kB; lsn=0/5CF501E0, redo lsn=0/5CF501A8
2025-11-05 17:33:50.493 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near "ls" at character 1
2025-11-05 17:33:50.493 IST [52582] jagdish_pandre@test_db STATEMENT:  ls
	SELECT * FROM pdcd_schema.load_snapshot_tbl();
2025-11-05 17:34:06.871 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near "ls" at character 1
2025-11-05 17:34:06.871 IST [52582] jagdish_pandre@test_db STATEMENT:  ls
	SELECT * FROM pdcd_schema.load_snapshot_tbl();
2025-11-05 17:34:14.491 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 17:34:14.844 IST [54409] @ LOG:  checkpoint complete: wrote 4 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.323 s, sync=0.003 s, total=0.354 s; sync files=4, longest=0.002 s, average=0.001 s; distance=0 kB, estimate=199 kB; lsn=0/5CF50598, redo lsn=0/5CF50560
2025-11-05 17:36:44.769 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near ";" at character 80
2025-11-05 17:36:44.769 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT * FROM pdcd_schema.load_audit_md5_metadata_tbl(ARRAY['analytics_schema'];
	)
	;
2025-11-05 17:36:59.025 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_audit_md5_metadata_tbl(text[]) does not exist at character 15
2025-11-05 17:36:59.025 IST [52582] jagdish_pandre@test_db HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2025-11-05 17:36:59.025 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT * FROM pdcd_schema.load_audit_md5_metadata_tbl(ARRAY['analytics_schema']);
2025-11-05 17:39:35.060 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_table (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:39:43.159 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id INTEGER,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:39:43.162 IST [52582] jagdish_pandre@test_db ERROR:  return type mismatch in function declared to return record
2025-11-05 17:39:43.162 IST [52582] jagdish_pandre@test_db DETAIL:  Final statement returns text instead of integer at column 1.
2025-11-05 17:39:43.162 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "load_audit_md5_metadata_tbl"
2025-11-05 17:39:43.162 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id INTEGER,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:41:59.266 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:41:59.267 IST [52582] jagdish_pandre@test_db ERROR:  return type mismatch in function declared to return record
2025-11-05 17:41:59.267 IST [52582] jagdish_pandre@test_db DETAIL:  Final statement returns text instead of bigint at column 1.
2025-11-05 17:41:59.267 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "load_audit_md5_metadata_tbl"
2025-11-05 17:41:59.267 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:44:14.862 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 17:44:15.851 IST [54409] @ LOG:  checkpoint complete: wrote 10 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.956 s, sync=0.004 s, total=0.990 s; sync files=9, longest=0.003 s, average=0.001 s; distance=41 kB, estimate=183 kB; lsn=0/5CF5A9D8, redo lsn=0/5CF5A9A0
2025-11-05 17:46:18.601 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:46:18.603 IST [52582] jagdish_pandre@test_db ERROR:  return type mismatch in function declared to return record
2025-11-05 17:46:18.603 IST [52582] jagdish_pandre@test_db DETAIL:  Final statement returns text instead of bigint at column 1.
2025-11-05 17:46:18.603 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "load_audit_md5_metadata_tbl"
2025-11-05 17:46:18.603 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH latest_snapshot AS (
	        SELECT 
	            snapshot_id,
	            snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	        ORDER BY snapshot_id DESC
	        LIMIT 1
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ls.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN latest_snapshot ls
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:49:14.856 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 17:49:15.531 IST [54409] @ LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.649 s, sync=0.003 s, total=0.676 s; sync files=7, longest=0.002 s, average=0.001 s; distance=33 kB, estimate=168 kB; lsn=0/5CF63048, redo lsn=0/5CF63010
2025-11-05 17:49:18.206 IST [99854] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64519
2025-11-05 17:49:18.209 IST [99854] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 17:49:18.227 IST [99854] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.021 user=jagdish_pandre database=postgres host=127.0.0.1 port=64519
2025-11-05 17:49:18.230 IST [99855] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64520
2025-11-05 17:49:18.233 IST [99855] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 17:49:18.259 IST [99856] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64521
2025-11-05 17:49:18.261 IST [99856] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 17:49:18.340 IST [99857] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64522
2025-11-05 17:49:18.343 IST [99857] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 17:49:18.352 IST [99858] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64523
2025-11-05 17:49:18.354 IST [99858] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 17:49:18.384 IST [99860] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=64524
2025-11-05 17:49:18.387 IST [99860] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 17:53:56.173 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.load_audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:53:56.175 IST [52582] jagdish_pandre@test_db ERROR:  relation "pdcd_schema.load_audit_md5_metadata_tbl" does not exist at character 892
2025-11-05 17:53:56.175 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.load_audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:54:14.539 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 17:54:15.208 IST [54409] @ LOG:  checkpoint complete: wrote 7 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.641 s, sync=0.004 s, total=0.669 s; sync files=7, longest=0.002 s, average=0.001 s; distance=34 kB, estimate=155 kB; lsn=0/5CF6BC38, redo lsn=0/5CF6BC00
2025-11-05 17:54:47.759 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:54:47.761 IST [52582] jagdish_pandre@test_db ERROR:  return type mismatch in function declared to return record
2025-11-05 17:54:47.761 IST [52582] jagdish_pandre@test_db DETAIL:  Final statement returns text instead of bigint at column 1.
2025-11-05 17:54:47.761 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "audit_md5_metadata_tbl"
2025-11-05 17:54:47.761 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:58:40.647 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.audit_md5_metadata_tbl;
2025-11-05 17:58:40.667 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE IF NOT EXISTS pdcd_schema.audit_md5_metadata_tbl (
	    metadata_id BIGSERIAL PRIMARY KEY,
	    snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	    schema_name TEXT NOT NULL,
	    object_type TEXT NOT NULL,          -- TABLE, VIEW, FUNCTION, ...
	    object_type_name TEXT NOT NULL,     -- table/view name
	    object_subtype TEXT,                -- Column, Index, Trigger, ...
	    object_subtype_name TEXT,           -- column name or index name
	    object_subtype_details TEXT,        -- raw detail string
	    object_md5 TEXT NOT NULL,           -- md5 fingerprint of the object_subtype_details (or full row)
	    processed_time TIMESTAMP DEFAULT clock_timestamp()
	);
2025-11-05 17:58:53.289 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:58:53.291 IST [52582] jagdish_pandre@test_db ERROR:  return type mismatch in function declared to return record
2025-11-05 17:58:53.291 IST [52582] jagdish_pandre@test_db DETAIL:  Final statement returns too few columns.
2025-11-05 17:58:53.291 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "audit_md5_metadata_tbl"
2025-11-05 17:58:53.291 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 17:59:14.212 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 17:59:19.274 IST [54409] @ LOG:  checkpoint complete: wrote 49 buffers (0.3%); 0 WAL file(s) added, 0 removed, 0 recycled; write=5.004 s, sync=0.025 s, total=5.063 s; sync files=43, longest=0.007 s, average=0.001 s; distance=212 kB, estimate=212 kB; lsn=0/5CFA0C90, redo lsn=0/5CFA0C58
2025-11-05 18:00:04.358 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 18:00:04.360 IST [52582] jagdish_pandre@test_db ERROR:  return type mismatch in function declared to return record
2025-11-05 18:00:04.360 IST [52582] jagdish_pandre@test_db DETAIL:  Final statement returns too few columns.
2025-11-05 18:00:04.360 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL function "audit_md5_metadata_tbl"
2025-11-05 18:00:04.360 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 18:03:37.161 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time   --  added this
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 18:03:53.501 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_audit_md5_metadata_tbl(text[]) does not exist at character 15
2025-11-05 18:03:53.501 IST [52582] jagdish_pandre@test_db HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2025-11-05 18:03:53.501 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT * FROM pdcd_schema.load_audit_md5_metadata_tbl(ARRAY['analytics_schema']);
2025-11-05 18:04:14.281 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 18:04:15.157 IST [54409] @ LOG:  checkpoint complete: wrote 9 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.845 s, sync=0.003 s, total=0.877 s; sync files=7, longest=0.002 s, average=0.001 s; distance=34 kB, estimate=194 kB; lsn=0/5CFA97B8, redo lsn=0/5CFA9780
2025-11-05 18:05:39.406 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_audit_md5_metadata_tbl(TEXT []);
2025-11-05 18:05:39.406 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_audit_md5_metadata_tbl(text[]) does not exist
2025-11-05 18:05:39.406 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_audit_md5_metadata_tbl(TEXT []);
2025-11-05 18:05:47.442 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.audit_md5_metadata_tbl(TEXT []);
2025-11-05 18:05:54.408 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time   --  added this
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 18:09:14.134 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 18:09:16.373 IST [54409] @ LOG:  checkpoint complete: wrote 22 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.209 s, sync=0.005 s, total=2.239 s; sync files=20, longest=0.002 s, average=0.001 s; distance=39 kB, estimate=178 kB; lsn=0/5CFB3508, redo lsn=0/5CFB34D0
2025-11-05 18:19:14.379 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 18:19:16.878 IST [54409] @ LOG:  checkpoint complete: wrote 24 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.398 s, sync=0.041 s, total=2.499 s; sync files=33, longest=0.006 s, average=0.002 s; distance=88 kB, estimate=169 kB; lsn=0/5CFC9700, redo lsn=0/5CFC96C8
2025-11-05 18:22:05.913 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near "table" at character 16
2025-11-05 18:22:05.913 IST [52582] jagdish_pandre@test_db STATEMENT:  select * from  table pdcd_schema.md5_metadata_table ;
2025-11-05 18:24:14.886 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 18:24:15.790 IST [54409] @ LOG:  checkpoint complete: wrote 9 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.847 s, sync=0.020 s, total=0.905 s; sync files=12, longest=0.007 s, average=0.002 s; distance=22 kB, estimate=155 kB; lsn=0/5CFCF010, redo lsn=0/5CFCEFD8
2025-11-05 18:29:21.231 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.snapshot_tbl
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_table (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 18:34:14.797 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 18:34:17.659 IST [54409] @ LOG:  checkpoint complete: wrote 27 buffers (0.2%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.735 s, sync=0.053 s, total=2.863 s; sync files=42, longest=0.007 s, average=0.002 s; distance=99 kB, estimate=149 kB; lsn=0/5CFE7F78, redo lsn=0/5CFE7F40
2025-11-05 18:35:33.594 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_audit_md5_metadata_tbl(TEXT[]);
2025-11-05 18:36:28.777 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_md5_metadata_tbl(TEXT[]);
2025-11-05 18:37:27.799 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT MAX(snapshot_id) as snapshot_id
	        FROM pdcd_schema.snapshot_tbl
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_table (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 18:37:27.800 IST [52582] jagdish_pandre@test_db ERROR:  column ns.processed_time does not exist at character 1975
2025-11-05 18:37:27.800 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT MAX(snapshot_id) as snapshot_id
	        FROM pdcd_schema.snapshot_tbl
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_table (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 18:38:36.705 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT MAX(snapshot_id) as snapshot_id
	        FROM pdcd_schema.snapshot_tbl
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_table (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        clock_timestamp() AS processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 18:39:14.648 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 18:39:15.935 IST [54409] @ LOG:  checkpoint complete: wrote 13 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.261 s, sync=0.004 s, total=1.287 s; sync files=12, longest=0.002 s, average=0.001 s; distance=45 kB, estimate=139 kB; lsn=0/5CFF3540, redo lsn=0/5CFF3508
2025-11-05 18:44:14.937 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 18:44:19.580 IST [54409] @ LOG:  checkpoint complete: wrote 45 buffers (0.3%); 0 WAL file(s) added, 1 removed, 0 recycled; write=4.527 s, sync=0.043 s, total=4.643 s; sync files=34, longest=0.007 s, average=0.002 s; distance=178 kB, estimate=178 kB; lsn=0/5D01FFA8, redo lsn=0/5D01FF70
2025-11-05 18:47:29.637 IST [99855] jagdish_pandre@postgres LOG:  disconnection: session time: 0:58:11.406 user=jagdish_pandre database=postgres host=127.0.0.1 port=64520
2025-11-05 18:47:29.683 IST [99856] jagdish_pandre@postgres LOG:  disconnection: session time: 0:58:11.424 user=jagdish_pandre database=postgres host=127.0.0.1 port=64521
2025-11-05 18:47:29.689 IST [99857] jagdish_pandre@test_db LOG:  disconnection: session time: 0:58:11.347 user=jagdish_pandre database=test_db host=127.0.0.1 port=64522
2025-11-05 18:47:29.690 IST [99860] jagdish_pandre@test_db LOG:  disconnection: session time: 0:58:11.305 user=jagdish_pandre database=test_db host=127.0.0.1 port=64524
2025-11-05 18:47:29.692 IST [99858] jagdish_pandre@test_db LOG:  disconnection: session time: 0:58:11.340 user=jagdish_pandre database=test_db host=127.0.0.1 port=64523
2025-11-05 19:04:29.638 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.audit_md5_metadata_tbl;
2025-11-05 19:04:35.294 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.md5_metadata_table;
2025-11-05 19:04:38.649 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.snapshot_tbl;
2025-11-05 19:05:15.681 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:05:15.681 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_snapshot_tbl(text[]) does not exist
2025-11-05 19:05:15.681 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:05:15.681 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_md5_metadata_tbl(TEXT[]);
2025-11-05 19:05:15.691 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_audit_md5_metadata_tbl(TEXT[]);
2025-11-05 19:05:15.691 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_audit_md5_metadata_tbl(text[]) does not exist
2025-11-05 19:05:15.691 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_audit_md5_metadata_tbl(TEXT[]);
2025-11-05 19:06:13.854 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 19:06:19.787 IST [54409] @ LOG:  checkpoint complete: wrote 58 buffers (0.4%); 0 WAL file(s) added, 0 removed, 0 recycled; write=5.883 s, sync=0.007 s, total=5.934 s; sync files=27, longest=0.003 s, average=0.001 s; distance=284 kB, estimate=284 kB; lsn=0/5D067328, redo lsn=0/5D0672F0
2025-11-05 19:06:55.271 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:06:55.272 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_snapshot_tbl(text[]) does not exist
2025-11-05 19:06:55.272 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:07:30.536 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:07:30.536 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_snapshot_tbl(text[]) does not exist
2025-11-05 19:07:30.536 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:08:05.131 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near "pdcd_schema" at character 7
2025-11-05 19:08:05.131 IST [52582] jagdish_pandre@test_db STATEMENT:  drop  pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:08:27.483 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function  pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:08:27.483 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_snapshot_tbl(text[]) does not exist
2025-11-05 19:08:27.483 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function  pdcd_schema.load_snapshot_tbl(TEXT[]);
2025-11-05 19:09:06.693 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_snapshot_tbl
	;
2025-11-05 19:09:56.067 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.snapshot_tbl;
2025-11-05 19:09:56.069 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE pdcd_schema.snapshot_tbl (
	  snapshot_id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	  snapshot_name TEXT NOT NULL,
	  snapshot_process_time TIMESTAMP DEFAULT clock_timestamp()
	);
2025-11-05 19:09:56.113 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_snapshot_tbl()
	RETURNS TABLE (
	    snapshot_id INT,
	    snapshot_name TEXT,
	    snapshot_process_time TIMESTAMP
	)
	LANGUAGE SQL
	AS $function$
	    INSERT INTO pdcd_schema.snapshot_tbl (snapshot_name)
	    VALUES (
	        CONCAT_WS('_',
	            'snapshot',
	            COALESCE((SELECT MAX(snapshot_id) FROM pdcd_schema.snapshot_tbl), 0) + 1,
	            TO_CHAR(clock_timestamp(), 'YYYYMMDD_HH24MISS')
	        )
	    )
	    RETURNING snapshot_id, snapshot_name, snapshot_process_time;
	$function$;
2025-11-05 19:10:39.174 IST [52582] jagdish_pandre@test_db ERROR:  relation "pdcd_schema.load_snapshot_tbl" does not exist at character 15
2025-11-05 19:10:39.174 IST [52582] jagdish_pandre@test_db STATEMENT:  select * from pdcd_schema.load_snapshot_tbl;
2025-11-05 19:11:09.111 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.audit_md5_metadata_tbl;
2025-11-05 19:11:09.112 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE pdcd_schema.audit_md5_metadata_tbl (
	  metadata_id BIGSERIAL PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,
	  object_type_name TEXT NOT NULL,
	  object_subtype TEXT,
	  object_subtype_name TEXT,
	  object_subtype_details TEXT,
	  object_md5 TEXT NOT NULL,
	  processed_time TIMESTAMP DEFAULT clock_timestamp()
	);
2025-11-05 19:11:09.128 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time   --  added this
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 19:11:13.790 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 19:11:19.899 IST [54409] @ LOG:  checkpoint complete: wrote 59 buffers (0.4%); 0 WAL file(s) added, 0 removed, 0 recycled; write=6.062 s, sync=0.028 s, total=6.110 s; sync files=50, longest=0.006 s, average=0.001 s; distance=229 kB, estimate=279 kB; lsn=0/5D0A0B18, redo lsn=0/5D0A0AE0
2025-11-05 19:12:10.774 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_audit_md5_metadata_tbl;
2025-11-05 19:14:13.677 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.md5_metadata_table;
2025-11-05 19:14:13.678 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE IF NOT EXISTS pdcd_schema.md5_metadata_table (
	  metadata_id BIGSERIAL PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,          -- TABLE, VIEW, FUNCTION, ...
	  object_type_name TEXT NOT NULL,     -- table/view name
	  object_subtype TEXT,                -- Column, Index, Trigger, ...
	  object_subtype_name TEXT,           -- column name or index name
	  object_subtype_details TEXT,        -- raw detail string
	  object_md5 TEXT NOT NULL,           -- md5 fingerprint of the object_subtype_details (or full row)
	  processed_time TIMESTAMP DEFAULT clock_timestamp(),
	  change_type TEXT DEFAULT 'ADDED'   -- ADDED | MODIFIED | UNCHANGED | DELETED (we'll use ADDED/MODIFIED/DELETED on insert)
	);
2025-11-05 19:14:13.694 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT MAX(snapshot_id) as snapshot_id
	        FROM pdcd_schema.snapshot_tbl
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_table (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        clock_timestamp() AS processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 19:14:31.031 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_md5_metadata_table() does not exist at character 15
2025-11-05 19:14:31.031 IST [52582] jagdish_pandre@test_db HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2025-11-05 19:14:31.031 IST [52582] jagdish_pandre@test_db STATEMENT:  select * from pdcd_schema.load_md5_metadata_table();
2025-11-05 19:15:58.619 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.md5_metadata_table ;
2025-11-05 19:16:10.200 IST [52582] jagdish_pandre@test_db LOG:  statement: drop table pdcd_schema.audit_md5_metadata_tbl ;
2025-11-05 19:16:13.902 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 19:16:20.062 IST [54409] @ LOG:  checkpoint complete: wrote 60 buffers (0.4%); 0 WAL file(s) added, 0 removed, 0 recycled; write=6.107 s, sync=0.015 s, total=6.160 s; sync files=44, longest=0.002 s, average=0.001 s; distance=307 kB, estimate=307 kB; lsn=0/5D0ED8D0, redo lsn=0/5D0ED898
2025-11-05 19:16:30.018 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.audit_md5_metadata_tbl ;
2025-11-05 19:16:30.018 IST [52582] jagdish_pandre@test_db ERROR:  could not find a function named "pdcd_schema.audit_md5_metadata_tbl"
2025-11-05 19:16:30.018 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.audit_md5_metadata_tbl ;
2025-11-05 19:16:40.977 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_audit_md5_metadata_tbl() ;
2025-11-05 19:16:40.977 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_audit_md5_metadata_tbl() does not exist
2025-11-05 19:16:40.977 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_audit_md5_metadata_tbl() ;
2025-11-05 19:16:43.203 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_audit_md5_metadata_tbl ;
2025-11-05 19:16:43.203 IST [52582] jagdish_pandre@test_db ERROR:  could not find a function named "pdcd_schema.load_audit_md5_metadata_tbl"
2025-11-05 19:16:43.203 IST [52582] jagdish_pandre@test_db STATEMENT:  drop function pdcd_schema.load_audit_md5_metadata_tbl ;
2025-11-05 19:17:37.441 IST [6725] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50076
2025-11-05 19:17:37.445 IST [6725] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 19:17:37.461 IST [6725] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.019 user=jagdish_pandre database=postgres host=127.0.0.1 port=50076
2025-11-05 19:17:37.465 IST [6726] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50077
2025-11-05 19:17:37.469 IST [6726] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 19:17:37.524 IST [6727] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50078
2025-11-05 19:17:37.527 IST [6727] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 19:17:37.587 IST [6728] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50079
2025-11-05 19:17:37.591 IST [6728] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:17:37.621 IST [6729] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50080
2025-11-05 19:17:37.623 IST [6729] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:17:37.654 IST [6730] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50081
2025-11-05 19:17:37.657 IST [6730] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:18:20.368 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.md5_metadata_tbl;
2025-11-05 19:18:20.368 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE IF NOT EXISTS pdcd_schema.md5_metadata_tbl (
	  metadata_id BIGSERIAL PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,          -- TABLE, VIEW, FUNCTION, ...
	  object_type_name TEXT NOT NULL,     -- table/view name
	  object_subtype TEXT,                -- Column, Index, Trigger, ...
	  object_subtype_name TEXT,           -- column name or index name
	  object_subtype_details TEXT,        -- raw detail string
	  object_md5 TEXT NOT NULL,           -- md5 fingerprint of the object_subtype_details (or full row)
	  processed_time TIMESTAMP DEFAULT clock_timestamp(),
	  change_type TEXT DEFAULT 'ADDED'   -- ADDED | MODIFIED | UNCHANGED | DELETED (we'll use ADDED/MODIFIED/DELETED on insert)
	);
2025-11-05 19:18:20.395 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT MAX(snapshot_id) as snapshot_id
	        FROM pdcd_schema.snapshot_tbl
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        clock_timestamp() AS processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 19:21:13.057 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 19:21:19.938 IST [54409] @ LOG:  checkpoint complete: wrote 67 buffers (0.4%); 0 WAL file(s) added, 0 removed, 0 recycled; write=6.840 s, sync=0.015 s, total=6.882 s; sync files=41, longest=0.006 s, average=0.001 s; distance=227 kB, estimate=299 kB; lsn=0/5D126568, redo lsn=0/5D126530
2025-11-05 19:25:53.634 IST [52582] jagdish_pandre@test_db LOG:  statement: alter table analytics_schema.departments add column secondary_location TEXT;
2025-11-05 19:26:13.940 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 19:26:15.558 IST [54409] @ LOG:  checkpoint complete: wrote 16 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.581 s, sync=0.013 s, total=1.618 s; sync files=16, longest=0.006 s, average=0.001 s; distance=71 kB, estimate=276 kB; lsn=0/5D138290, redo lsn=0/5D138258
2025-11-05 19:28:15.192 IST [6726] jagdish_pandre@postgres LOG:  disconnection: session time: 0:10:37.726 user=jagdish_pandre database=postgres host=127.0.0.1 port=50077
2025-11-05 19:28:15.204 IST [6727] jagdish_pandre@postgres LOG:  disconnection: session time: 0:10:37.679 user=jagdish_pandre database=postgres host=127.0.0.1 port=50078
2025-11-05 19:28:15.217 IST [6728] jagdish_pandre@test_db LOG:  disconnection: session time: 0:10:37.629 user=jagdish_pandre database=test_db host=127.0.0.1 port=50079
2025-11-05 19:28:15.229 IST [6729] jagdish_pandre@test_db LOG:  disconnection: session time: 0:10:37.608 user=jagdish_pandre database=test_db host=127.0.0.1 port=50080
2025-11-05 19:28:15.242 IST [6730] jagdish_pandre@test_db LOG:  disconnection: session time: 0:10:37.587 user=jagdish_pandre database=test_db host=127.0.0.1 port=50081
2025-11-05 19:28:15.259 IST [7470] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50289
2025-11-05 19:28:15.263 IST [7470] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 19:28:15.276 IST [7470] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.017 user=jagdish_pandre database=postgres host=127.0.0.1 port=50289
2025-11-05 19:28:15.278 IST [7471] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50290
2025-11-05 19:28:15.281 IST [7471] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 19:28:15.312 IST [7472] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50291
2025-11-05 19:28:15.315 IST [7472] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 19:28:15.361 IST [7473] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50292
2025-11-05 19:28:15.365 IST [7473] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:28:15.398 IST [7474] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50293
2025-11-05 19:28:15.400 IST [7474] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:28:16.006 IST [7476] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50294
2025-11-05 19:28:16.015 IST [7476] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:28:16.024 IST [7477] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50295
2025-11-05 19:28:16.026 IST [7477] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:28:59.408 IST [7527] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50313
2025-11-05 19:28:59.411 IST [7527] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:29:17.310 IST [7527] jagdish_pandre@test_db LOG:  disconnection: session time: 0:00:17.901 user=jagdish_pandre database=test_db host=127.0.0.1 port=50313
2025-11-05 19:29:31.745 IST [7578] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=50322
2025-11-05 19:29:31.747 IST [7578] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 19:29:42.317 IST [7578] jagdish_pandre@test_db LOG:  disconnection: session time: 0:00:10.572 user=jagdish_pandre database=test_db host=127.0.0.1 port=50322
2025-11-05 19:31:13.560 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 19:31:14.748 IST [54409] @ LOG:  checkpoint complete: wrote 12 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.157 s, sync=0.004 s, total=1.189 s; sync files=12, longest=0.002 s, average=0.001 s; distance=5 kB, estimate=249 kB; lsn=0/5D1398E8, redo lsn=0/5D1398B0
2025-11-05 19:36:40.506 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.md5_metadata_tbl;
2025-11-05 19:36:40.527 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE IF NOT EXISTS pdcd_schema.md5_metadata_tbl (
	  metadata_id BIGSERIAL PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,          -- TABLE, VIEW, FUNCTION, ...
	  object_type_name TEXT NOT NULL,     -- table/view name
	  object_subtype TEXT,                -- Column, Index, Trigger, ...
	  object_subtype_name TEXT,           -- column name or index name
	  object_subtype_details TEXT,        -- raw detail string
	  object_md5 TEXT NOT NULL,           -- md5 fingerprint of the object_subtype_details (or full row)
	  processed_time TIMESTAMP DEFAULT clock_timestamp(),
	  change_type TEXT DEFAULT 'ADDED'   -- ADDED | MODIFIED | UNCHANGED | DELETED (we'll use ADDED/MODIFIED/DELETED on insert)
	);
2025-11-05 19:36:40.538 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP,
	    change_type TEXT
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT MAX(snapshot_id) as snapshot_id
	        FROM pdcd_schema.snapshot_tbl
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5,
	            change_type
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5,
	            'ADDED'
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5, change_type
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        clock_timestamp() AS processed_time,
	        i.change_type
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 19:41:13.764 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 19:41:19.621 IST [54409] @ LOG:  checkpoint complete: wrote 56 buffers (0.3%); 0 WAL file(s) added, 0 removed, 0 recycled; write=5.799 s, sync=0.026 s, total=5.859 s; sync files=44, longest=0.006 s, average=0.001 s; distance=239 kB, estimate=248 kB; lsn=0/5D1755E8, redo lsn=0/5D1755B0
2025-11-05 19:43:59.146 IST [52582] jagdish_pandre@test_db ERROR:  relation "pdcd_schema.audit_md5_metadata_tbl" does not exist at character 15
2025-11-05 19:43:59.146 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT * FROM pdcd_schema.audit_md5_metadata_tbl;
2025-11-05 19:44:29.980 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP TABLE IF EXISTS pdcd_schema.audit_md5_metadata_tbl;
2025-11-05 19:44:29.981 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE TABLE pdcd_schema.audit_md5_metadata_tbl (
	  metadata_id BIGSERIAL PRIMARY KEY,
	  snapshot_id INT NOT NULL REFERENCES pdcd_schema.snapshot_tbl(snapshot_id) ON DELETE CASCADE,
	  schema_name TEXT NOT NULL,
	  object_type TEXT NOT NULL,
	  object_type_name TEXT NOT NULL,
	  object_subtype TEXT,
	  object_subtype_name TEXT,
	  object_subtype_details TEXT,
	  object_md5 TEXT NOT NULL,
	  processed_time TIMESTAMP DEFAULT clock_timestamp()
	);
2025-11-05 19:44:30.009 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_audit_md5_metadata_tbl(
	    p_table_list TEXT[] DEFAULT NULL
	)
	RETURNS TABLE (
	    metadata_id BIGINT,
	    snapshot_id INTEGER,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    object_md5 TEXT,
	    processed_time TIMESTAMP
	)
	LANGUAGE SQL
	AS $function$
	    WITH new_snapshot AS (
	        SELECT snapshot_id, snapshot_process_time AS processed_time
	        FROM pdcd_schema.load_snapshot_tbl()
	    ),
	    combined_data AS (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	    ),
	    inserted AS (
	        INSERT INTO pdcd_schema.audit_md5_metadata_tbl (
	            snapshot_id,
	            schema_name,
	            object_type,
	            object_type_name,
	            object_subtype,
	            object_subtype_name,
	            object_subtype_details,
	            object_md5
	        )
	        SELECT
	            ns.snapshot_id,
	            c.schema_name,
	            c.object_type,
	            c.object_name AS object_type_name,
	            c.object_subtype,
	            c.object_subtype_name,
	            c.object_subtype_details,
	            c.object_md5
	        FROM combined_data c
	        CROSS JOIN new_snapshot ns
	        RETURNING metadata_id, snapshot_id, schema_name, object_type, object_type_name,
	                  object_subtype, object_subtype_name, object_subtype_details,
	                  object_md5
	    )
	    SELECT
	        i.metadata_id,
	        i.snapshot_id,
	        i.schema_name,
	        i.object_type,
	        i.object_type_name,
	        i.object_subtype,
	        i.object_subtype_name,
	        i.object_subtype_details,
	        i.object_md5,
	        ns.processed_time   --  added this
	    FROM inserted i
	    JOIN new_snapshot ns ON TRUE
	    ORDER BY i.schema_name, i.object_type_name, i.object_subtype;
	$function$;
2025-11-05 19:46:13.625 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 19:46:21.593 IST [54409] @ LOG:  checkpoint complete: wrote 78 buffers (0.5%); 0 WAL file(s) added, 0 removed, 0 recycled; write=7.933 s, sync=0.016 s, total=7.969 s; sync files=52, longest=0.006 s, average=0.001 s; distance=339 kB, estimate=339 kB; lsn=0/5D1CA2C8, redo lsn=0/5D1CA290
2025-11-05 19:56:12.091 IST [7471] jagdish_pandre@postgres LOG:  disconnection: session time: 0:27:56.813 user=jagdish_pandre database=postgres host=127.0.0.1 port=50290
2025-11-05 19:56:12.104 IST [7472] jagdish_pandre@postgres LOG:  disconnection: session time: 0:27:56.791 user=jagdish_pandre database=postgres host=127.0.0.1 port=50291
2025-11-05 19:56:12.121 IST [7473] jagdish_pandre@test_db LOG:  disconnection: session time: 0:27:56.759 user=jagdish_pandre database=test_db host=127.0.0.1 port=50292
2025-11-05 19:56:12.135 IST [7474] jagdish_pandre@test_db LOG:  disconnection: session time: 0:27:56.737 user=jagdish_pandre database=test_db host=127.0.0.1 port=50293
2025-11-05 21:32:11.179 IST [14824] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=55409
2025-11-05 21:32:11.182 IST [14824] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 21:32:11.207 IST [14824] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.028 user=jagdish_pandre database=postgres host=127.0.0.1 port=55409
2025-11-05 21:32:11.211 IST [14825] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=55410
2025-11-05 21:32:11.215 IST [14825] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 21:32:11.292 IST [14826] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=55411
2025-11-05 21:32:11.297 IST [14826] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 21:32:11.522 IST [14828] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=55412
2025-11-05 21:32:11.526 IST [14828] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 21:32:11.538 IST [14829] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=55413
2025-11-05 21:32:11.540 IST [14829] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 21:32:11.578 IST [14830] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=55414
2025-11-05 21:32:11.582 IST [14830] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 21:32:11.654 IST [14831] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=55415
2025-11-05 21:32:11.658 IST [14831] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 21:32:11.710 IST [14832] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=55416
2025-11-05 21:32:11.712 IST [14832] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 21:32:31.013 IST [14831] jagdish_pandre@test_db LOG:  disconnection: session time: 0:00:19.358 user=jagdish_pandre database=test_db host=127.0.0.1 port=55415
2025-11-05 21:35:23.136 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 21:35:25.622 IST [54409] @ LOG:  checkpoint complete: wrote 24 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.372 s, sync=0.059 s, total=2.487 s; sync files=36, longest=0.005 s, average=0.002 s; distance=63 kB, estimate=311 kB; lsn=0/5D1D9ED0, redo lsn=0/5D1D9E98
2025-11-05 21:36:04.339 IST [52582] jagdish_pandre@test_db LOG:  statement: alter table analytics_schema.departments drop column secondary_location ;
2025-11-05 21:36:12.219 IST [52582] jagdish_pandre@test_db LOG:  statement: alter table analytics_schema.departments drop column primary_location ;
2025-11-05 21:36:32.068 IST [52582] jagdish_pandre@test_db ERROR:  relation "pdcd_schema.md5_metadata_tbll" does not exist at character 15
2025-11-05 21:36:32.068 IST [52582] jagdish_pandre@test_db STATEMENT:  select * from pdcd_schema.md5_metadata_tbll
	;
2025-11-05 21:39:21.857 IST [52582] jagdish_pandre@test_db ERROR:  syntax error at or near "column" at character 43
2025-11-05 21:39:21.857 IST [52582] jagdish_pandre@test_db STATEMENT:  alter table analytics_schema.departments  column primary_location ;
2025-11-05 21:40:23.624 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 21:40:25.852 IST [54409] @ LOG:  checkpoint complete: wrote 22 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=2.202 s, sync=0.005 s, total=2.229 s; sync files=17, longest=0.002 s, average=0.001 s; distance=12 kB, estimate=281 kB; lsn=0/5D1DD288, redo lsn=0/5D1DD250
2025-11-05 21:55:14.379 IST [52582] jagdish_pandre@test_db LOG:  statement: ALTER TABLE pdcd_schema.md5_metadata_tbl
	ADD COLUMN IF NOT EXISTS prev_object_md5 TEXT,
	ADD COLUMN IF NOT EXISTS change_type TEXT DEFAULT 'ADDED';
2025-11-05 21:55:23.867 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 21:55:24.841 IST [54409] @ LOG:  checkpoint complete: wrote 10 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.948 s, sync=0.004 s, total=0.974 s; sync files=10, longest=0.003 s, average=0.001 s; distance=21 kB, estimate=255 kB; lsn=0/5D1E2970, redo lsn=0/5D1E2938
2025-11-05 21:55:46.011 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS TABLE (
	    snapshot_name TEXT,
	    processed_time TIMESTAMP,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    prev_object_md5 TEXT,
	    object_md5 TEXT,
	    change_type TEXT
	)
	LANGUAGE plpgsql
	AS $function$
	DECLARE
	    v_snapshot RECORD;
	BEGIN
	    --  Create a new snapshot entry
	    SELECT snapshot_name, snapshot_process_time AS processed_time
	    INTO v_snapshot
	    FROM pdcd_schema.load_snapshot_tbl();
	
	    -- ========================
	    -- 1 ADDED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        NULL AS prev_object_md5,
	        a.object_md5,
	        'ADDED'
	    FROM pdcd_schema.audit_md5_metadata_tbl a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE m.object_md5 IS NULL;
	
	    -- ========================
	    -- 2 MODIFIED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        a.object_md5,
	        'MODIFIED'
	    FROM pdcd_schema.audit_md5_metadata_tbl a
	    JOIN pdcd_schema.md5_metadata_tbl m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE a.object_md5 <> m.object_md5;
	
	    -- ========================
	    -- 3 DELETED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        NULL AS object_md5,
	        'DELETED'
	    FROM pdcd_schema.md5_metadata_tbl m
	    LEFT JOIN pdcd_schema.audit_md5_metadata_tbl a
	      ON m.schema_name = a.schema_name
	     AND m.object_type = a.object_type
	     AND m.object_type_name = a.object_type_name
	     AND COALESCE(m.object_subtype, '') = COALESCE(a.object_subtype, '')
	     AND COALESCE(m.object_subtype_name, '') = COALESCE(a.object_subtype_name, '')
	    WHERE a.object_md5 IS NULL;
	
	    --  Return only current snapshot's deltas
	    RETURN QUERY
	    SELECT
	        snapshot_name,
	        processed_time,
	        schema_name,
	        object_type,
	        object_type_name,
	        object_subtype,
	        object_subtype_name,
	        object_subtype_details,
	        prev_object_md5,
	        object_md5,
	        change_type
	    FROM pdcd_schema.md5_metadata_tbl
	    WHERE processed_time = v_snapshot.processed_time
	    ORDER BY schema_name, object_type_name, object_subtype_name;
	
	END;
	$function$;
2025-11-05 21:57:13.988 IST [52582] jagdish_pandre@test_db LOG:  statement: alter table analytics_schema.departments add column primary_location TEXT;
2025-11-05 21:57:59.446 IST [52582] jagdish_pandre@test_db ERROR:  function pdcd_schema.load_changed_md5_metadata() does not exist at character 15
2025-11-05 21:57:59.446 IST [52582] jagdish_pandre@test_db HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2025-11-05 21:57:59.446 IST [52582] jagdish_pandre@test_db STATEMENT:  select * from pdcd_schema.load_changed_md5_metadata();
2025-11-05 21:59:19.781 IST [52582] jagdish_pandre@test_db ERROR:  column reference "snapshot_name" is ambiguous at character 8
2025-11-05 21:59:19.781 IST [52582] jagdish_pandre@test_db DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2025-11-05 21:59:19.781 IST [52582] jagdish_pandre@test_db QUERY:  SELECT snapshot_name, snapshot_process_time AS processed_time
	                        FROM pdcd_schema.load_snapshot_tbl()
2025-11-05 21:59:19.781 IST [52582] jagdish_pandre@test_db CONTEXT:  PL/pgSQL function pdcd_schema.load_changed_md5_metadata_tbl() line 6 at SQL statement
2025-11-05 21:59:19.781 IST [52582] jagdish_pandre@test_db STATEMENT:  select * from pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:00:23.844 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 22:00:24.904 IST [54409] @ LOG:  checkpoint complete: wrote 11 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.043 s, sync=0.004 s, total=1.060 s; sync files=11, longest=0.002 s, average=0.001 s; distance=38 kB, estimate=234 kB; lsn=0/5D1EC3B8, redo lsn=0/5D1EC380
2025-11-05 22:05:32.861 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS VOID
	LANGUAGE plpgsql
	AS $$
	DECLARE
	    v_snapshot_name TEXT;
	    v_snapshot_time TIMESTAMP;
	BEGIN
	    -- 1 Get latest snapshot info safely
	    SELECT s.snapshot_name, s.snapshot_process_time
	    INTO v_snapshot_name, v_snapshot_time
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- 2 Insert only new or changed records (based on MD5 difference)
	    INSERT INTO pdcd_schema.load_md5_metadata_tbl (
	        snapshot_name,
	        processed_time,
	        schema_name,
	        object_type,
	        object_type_name,
	        object_subtype,
	        object_subtype_name,
	        object_subtype_details,
	        object_md5
	    )
	    SELECT
	        v_snapshot_name AS snapshot_name,
	        v_snapshot_time AS processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        a.object_md5
	    FROM pdcd_schema.load_audit_md5_metadata_tbl() AS a
	    LEFT JOIN pdcd_schema.load_md5_metadata_tbl AS m
	        ON  a.schema_name = m.schema_name
	        AND a.object_type = m.object_type
	        AND a.object_type_name = m.object_type_name
	        AND a.object_subtype = m.object_subtype
	        AND a.object_subtype_name = m.object_subtype_name
	    WHERE m.object_md5 IS DISTINCT FROM a.object_md5
	       OR m.object_md5 IS NULL;
	
	    RAISE NOTICE ' Changes loaded successfully for snapshot: %', v_snapshot_name;
	END;
	$$;
2025-11-05 22:05:32.863 IST [52582] jagdish_pandre@test_db ERROR:  cannot change return type of existing function
2025-11-05 22:05:32.863 IST [52582] jagdish_pandre@test_db HINT:  Use DROP FUNCTION pdcd_schema.load_changed_md5_metadata_tbl() first.
2025-11-05 22:05:32.863 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS VOID
	LANGUAGE plpgsql
	AS $$
	DECLARE
	    v_snapshot_name TEXT;
	    v_snapshot_time TIMESTAMP;
	BEGIN
	    -- 1 Get latest snapshot info safely
	    SELECT s.snapshot_name, s.snapshot_process_time
	    INTO v_snapshot_name, v_snapshot_time
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- 2 Insert only new or changed records (based on MD5 difference)
	    INSERT INTO pdcd_schema.load_md5_metadata_tbl (
	        snapshot_name,
	        processed_time,
	        schema_name,
	        object_type,
	        object_type_name,
	        object_subtype,
	        object_subtype_name,
	        object_subtype_details,
	        object_md5
	    )
	    SELECT
	        v_snapshot_name AS snapshot_name,
	        v_snapshot_time AS processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        a.object_md5
	    FROM pdcd_schema.load_audit_md5_metadata_tbl() AS a
	    LEFT JOIN pdcd_schema.load_md5_metadata_tbl AS m
	        ON  a.schema_name = m.schema_name
	        AND a.object_type = m.object_type
	        AND a.object_type_name = m.object_type_name
	        AND a.object_subtype = m.object_subtype
	        AND a.object_subtype_name = m.object_subtype_name
	    WHERE m.object_md5 IS DISTINCT FROM a.object_md5
	       OR m.object_md5 IS NULL;
	
	    RAISE NOTICE ' Changes loaded successfully for snapshot: %', v_snapshot_name;
	END;
	$$;
2025-11-05 22:05:41.764 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP FUNCTION pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:05:45.353 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS VOID
	LANGUAGE plpgsql
	AS $$
	DECLARE
	    v_snapshot_name TEXT;
	    v_snapshot_time TIMESTAMP;
	BEGIN
	    -- 1 Get latest snapshot info safely
	    SELECT s.snapshot_name, s.snapshot_process_time
	    INTO v_snapshot_name, v_snapshot_time
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- 2 Insert only new or changed records (based on MD5 difference)
	    INSERT INTO pdcd_schema.load_md5_metadata_tbl (
	        snapshot_name,
	        processed_time,
	        schema_name,
	        object_type,
	        object_type_name,
	        object_subtype,
	        object_subtype_name,
	        object_subtype_details,
	        object_md5
	    )
	    SELECT
	        v_snapshot_name AS snapshot_name,
	        v_snapshot_time AS processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        a.object_md5
	    FROM pdcd_schema.load_audit_md5_metadata_tbl() AS a
	    LEFT JOIN pdcd_schema.load_md5_metadata_tbl AS m
	        ON  a.schema_name = m.schema_name
	        AND a.object_type = m.object_type
	        AND a.object_type_name = m.object_type_name
	        AND a.object_subtype = m.object_subtype
	        AND a.object_subtype_name = m.object_subtype_name
	    WHERE m.object_md5 IS DISTINCT FROM a.object_md5
	       OR m.object_md5 IS NULL;
	
	    RAISE NOTICE ' Changes loaded successfully for snapshot: %', v_snapshot_name;
	END;
	$$;
2025-11-05 22:06:14.359 IST [52582] jagdish_pandre@test_db ERROR:  relation "pdcd_schema.load_md5_metadata_tbl" does not exist at character 13
2025-11-05 22:06:14.359 IST [52582] jagdish_pandre@test_db QUERY:  INSERT INTO pdcd_schema.load_md5_metadata_tbl (
	        snapshot_name,
	        processed_time,
	        schema_name,
	        object_type,
	        object_type_name,
	        object_subtype,
	        object_subtype_name,
	        object_subtype_details,
	        object_md5
	    )
	    SELECT
	        v_snapshot_name AS snapshot_name,
	        v_snapshot_time AS processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        a.object_md5
	    FROM pdcd_schema.load_audit_md5_metadata_tbl() AS a
	    LEFT JOIN pdcd_schema.load_md5_metadata_tbl AS m
	        ON  a.schema_name = m.schema_name
	        AND a.object_type = m.object_type
	        AND a.object_type_name = m.object_type_name
	        AND a.object_subtype = m.object_subtype
	        AND a.object_subtype_name = m.object_subtype_name
	    WHERE m.object_md5 IS DISTINCT FROM a.object_md5
	       OR m.object_md5 IS NULL
2025-11-05 22:06:14.359 IST [52582] jagdish_pandre@test_db CONTEXT:  PL/pgSQL function pdcd_schema.load_changed_md5_metadata_tbl() line 12 at SQL statement
2025-11-05 22:06:14.359 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:06:47.465 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS VOID
	LANGUAGE plpgsql
	AS $$
	DECLARE
	    v_snapshot_name TEXT;
	    v_snapshot_time TIMESTAMP;
	BEGIN
	    -- 1 Get latest snapshot info safely
	    SELECT s.snapshot_name, s.snapshot_process_time
	    INTO v_snapshot_name, v_snapshot_time
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- 2 Insert only new or changed records (based on MD5 difference)
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name,
	        processed_time,
	        schema_name,
	        object_type,
	        object_type_name,
	        object_subtype,
	        object_subtype_name,
	        object_subtype_details,
	        object_md5
	    )
	    SELECT
	        v_snapshot_name AS snapshot_name,
	        v_snapshot_time AS processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        a.object_md5
	    FROM pdcd_schema.load_audit_md5_metadata_tbl() AS a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl AS m
	        ON  a.schema_name = m.schema_name
	        AND a.object_type = m.object_type
	        AND a.object_type_name = m.object_type_name
	        AND a.object_subtype = m.object_subtype
	        AND a.object_subtype_name = m.object_subtype_name
	    WHERE m.object_md5 IS DISTINCT FROM a.object_md5
	       OR m.object_md5 IS NULL;
	
	    RAISE NOTICE ' Changes loaded successfully for snapshot: %', v_snapshot_name;
	END;
	$$;
2025-11-05 22:07:03.106 IST [52582] jagdish_pandre@test_db ERROR:  column "snapshot_name" of relation "md5_metadata_tbl" does not exist at character 52
2025-11-05 22:07:03.106 IST [52582] jagdish_pandre@test_db QUERY:  INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name,
	        processed_time,
	        schema_name,
	        object_type,
	        object_type_name,
	        object_subtype,
	        object_subtype_name,
	        object_subtype_details,
	        object_md5
	    )
	    SELECT
	        v_snapshot_name AS snapshot_name,
	        v_snapshot_time AS processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        a.object_md5
	    FROM pdcd_schema.load_audit_md5_metadata_tbl() AS a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl AS m
	        ON  a.schema_name = m.schema_name
	        AND a.object_type = m.object_type
	        AND a.object_type_name = m.object_type_name
	        AND a.object_subtype = m.object_subtype
	        AND a.object_subtype_name = m.object_subtype_name
	    WHERE m.object_md5 IS DISTINCT FROM a.object_md5
	       OR m.object_md5 IS NULL
2025-11-05 22:07:03.106 IST [52582] jagdish_pandre@test_db CONTEXT:  PL/pgSQL function pdcd_schema.load_changed_md5_metadata_tbl() line 12 at SQL statement
2025-11-05 22:07:03.106 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:08:17.667 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP FUNCTION pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:09:44.837 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS TABLE (
	    snapshot_name TEXT,
	    processed_time TIMESTAMP,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    prev_object_md5 TEXT,
	    object_md5 TEXT,
	    change_type TEXT
	)
	LANGUAGE plpgsql
	AS $function$
	DECLARE
	    v_snapshot RECORD;
	BEGIN
	    --  Create a new snapshot entry
	    SELECT snapshot_name, snapshot_process_time AS processed_time
	    INTO v_snapshot
	    FROM pdcd_schema.load_snapshot_tbl();
	
	    -- ========================
	    -- 1 ADDED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        NULL AS prev_object_md5,
	        a.object_md5,
	        'ADDED'
	    FROM pdcd_schema.audit_md5_metadata_tbl a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE m.object_md5 IS NULL;
	
	    -- ========================
	    -- 2 MODIFIED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        a.object_md5,
	        'MODIFIED'
	    FROM pdcd_schema.audit_md5_metadata_tbl a
	    JOIN pdcd_schema.md5_metadata_tbl m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE a.object_md5 <> m.object_md5;
	
	    -- ========================
	    -- 3 DELETED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        NULL AS object_md5,
	        'DELETED'
	    FROM pdcd_schema.md5_metadata_tbl m
	    LEFT JOIN pdcd_schema.audit_md5_metadata_tbl a
	      ON m.schema_name = a.schema_name
	     AND m.object_type = a.object_type
	     AND m.object_type_name = a.object_type_name
	     AND COALESCE(m.object_subtype, '') = COALESCE(a.object_subtype, '')
	     AND COALESCE(m.object_subtype_name, '') = COALESCE(a.object_subtype_name, '')
	    WHERE a.object_md5 IS NULL;
	
	    --  Return only current snapshot's deltas
	    RETURN QUERY
	    SELECT
	        snapshot_name,
	        processed_time,
	        schema_name,
	        object_type,
	        object_type_name,
	        object_subtype,
	        object_subtype_name,
	        object_subtype_details,
	        prev_object_md5,
	        object_md5,
	        change_type
	    FROM pdcd_schema.md5_metadata_tbl
	    WHERE processed_time = v_snapshot.processed_time
	    ORDER BY schema_name, object_type_name, object_subtype_name;
	
	END;
	$function$;
2025-11-05 22:10:21.431 IST [52582] jagdish_pandre@test_db ERROR:  column reference "snapshot_name" is ambiguous at character 8
2025-11-05 22:10:21.431 IST [52582] jagdish_pandre@test_db DETAIL:  It could refer to either a PL/pgSQL variable or a table column.
2025-11-05 22:10:21.431 IST [52582] jagdish_pandre@test_db QUERY:  SELECT snapshot_name, snapshot_process_time AS processed_time
	                        FROM pdcd_schema.load_snapshot_tbl()
2025-11-05 22:10:21.431 IST [52582] jagdish_pandre@test_db CONTEXT:  PL/pgSQL function pdcd_schema.load_changed_md5_metadata_tbl() line 6 at SQL statement
2025-11-05 22:10:21.431 IST [52582] jagdish_pandre@test_db STATEMENT:  select * from pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:10:23.897 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 22:10:25.012 IST [54409] @ LOG:  checkpoint complete: wrote 11 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.082 s, sync=0.004 s, total=1.117 s; sync files=11, longest=0.002 s, average=0.001 s; distance=33 kB, estimate=214 kB; lsn=0/5D1F4B40, redo lsn=0/5D1F4B08
2025-11-05 22:11:54.671 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS TABLE (
	    snapshot_name TEXT,
	    processed_time TIMESTAMP,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    prev_object_md5 TEXT,
	    object_md5 TEXT,
	    change_type TEXT
	)
	LANGUAGE plpgsql
	AS $function$
	DECLARE
	    v_snapshot RECORD;
	BEGIN
	    --  Get the latest snapshot safely
	    SELECT s.snapshot_name, s.snapshot_process_time AS processed_time
	    INTO v_snapshot
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- ========================
	    -- 1 ADDED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        NULL AS prev_object_md5,
	        a.object_md5,
	        'ADDED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE m.object_md5 IS NULL;
	
	    -- ========================
	    -- 2 MODIFIED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        a.object_md5,
	        'MODIFIED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE a.object_md5 <> m.object_md5;
	
	    -- ========================
	    -- 3 DELETED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        NULL AS object_md5,
	        'DELETED'
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    LEFT JOIN pdcd_schema.audit_md5_metadata_tbl AS a
	      ON m.schema_name = a.schema_name
	     AND m.object_type = a.object_type
	     AND m.object_type_name = a.object_type_name
	     AND COALESCE(m.object_subtype, '') = COALESCE(a.object_subtype, '')
	     AND COALESCE(m.object_subtype_name, '') = COALESCE(a.object_subtype_name, '')
	    WHERE a.object_md5 IS NULL;
	
	    --  Return only new snapshot deltas
	    RETURN QUERY
	    SELECT
	        m.snapshot_name,
	        m.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.prev_object_md5,
	        m.object_md5,
	        m.change_type
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    WHERE m.processed_time = v_snapshot.processed_time
	    ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name;
	
	END;
	$function$;
2025-11-05 22:11:59.503 IST [52582] jagdish_pandre@test_db ERROR:  column "snapshot_name" of relation "md5_metadata_tbl" does not exist at character 52
2025-11-05 22:11:59.503 IST [52582] jagdish_pandre@test_db QUERY:  INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_name, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_name,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        NULL AS prev_object_md5,
	        a.object_md5,
	        'ADDED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE m.object_md5 IS NULL
2025-11-05 22:11:59.503 IST [52582] jagdish_pandre@test_db CONTEXT:  PL/pgSQL function pdcd_schema.load_changed_md5_metadata_tbl() line 13 at SQL statement
2025-11-05 22:11:59.503 IST [52582] jagdish_pandre@test_db STATEMENT:  select * from pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:15:23.014 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 22:15:23.786 IST [54409] @ LOG:  checkpoint complete: wrote 8 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.743 s, sync=0.004 s, total=0.773 s; sync files=8, longest=0.003 s, average=0.001 s; distance=16 kB, estimate=194 kB; lsn=0/5D1F8E50, redo lsn=0/5D1F8E18
2025-11-05 22:20:00.361 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS TABLE (
	    snapshot_id TEXT,
	    processed_time TIMESTAMP,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    prev_object_md5 TEXT,
	    object_md5 TEXT,
	    change_type TEXT
	)
	LANGUAGE plpgsql
	AS $function$
	DECLARE
	    v_snapshot RECORD;
	BEGIN
	    --  Get the latest snapshot safely
	    SELECT s.snapshot_id, s.snapshot_process_time AS processed_time
	    INTO v_snapshot
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- ========================
	    -- 1 ADDED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        NULL AS prev_object_md5,
	        a.object_md5,
	        'ADDED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE m.object_md5 IS NULL;
	
	    -- ========================
	    -- 2 MODIFIED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        a.object_md5,
	        'MODIFIED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE a.object_md5 <> m.object_md5;
	
	    -- ========================
	    -- 3 DELETED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        NULL AS object_md5,
	        'DELETED'
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    LEFT JOIN pdcd_schema.audit_md5_metadata_tbl AS a
	      ON m.schema_name = a.schema_name
	     AND m.object_type = a.object_type
	     AND m.object_type_name = a.object_type_name
	     AND COALESCE(m.object_subtype, '') = COALESCE(a.object_subtype, '')
	     AND COALESCE(m.object_subtype_name, '') = COALESCE(a.object_subtype_name, '')
	    WHERE a.object_md5 IS NULL;
	
	    --  Return only new snapshot deltas
	    RETURN QUERY
	    SELECT
	        m.snapshot_id,
	        m.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.prev_object_md5,
	        m.object_md5,
	        m.change_type
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    WHERE m.processed_time = v_snapshot.processed_time
	    ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name;
	
	END;
	$function$;
2025-11-05 22:20:00.361 IST [52582] jagdish_pandre@test_db ERROR:  cannot change return type of existing function
2025-11-05 22:20:00.361 IST [52582] jagdish_pandre@test_db DETAIL:  Row type defined by OUT parameters is different.
2025-11-05 22:20:00.361 IST [52582] jagdish_pandre@test_db HINT:  Use DROP FUNCTION pdcd_schema.load_changed_md5_metadata_tbl() first.
2025-11-05 22:20:00.361 IST [52582] jagdish_pandre@test_db STATEMENT:  CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS TABLE (
	    snapshot_id TEXT,
	    processed_time TIMESTAMP,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    prev_object_md5 TEXT,
	    object_md5 TEXT,
	    change_type TEXT
	)
	LANGUAGE plpgsql
	AS $function$
	DECLARE
	    v_snapshot RECORD;
	BEGIN
	    --  Get the latest snapshot safely
	    SELECT s.snapshot_id, s.snapshot_process_time AS processed_time
	    INTO v_snapshot
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- ========================
	    -- 1 ADDED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        NULL AS prev_object_md5,
	        a.object_md5,
	        'ADDED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE m.object_md5 IS NULL;
	
	    -- ========================
	    -- 2 MODIFIED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        a.object_md5,
	        'MODIFIED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE a.object_md5 <> m.object_md5;
	
	    -- ========================
	    -- 3 DELETED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        NULL AS object_md5,
	        'DELETED'
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    LEFT JOIN pdcd_schema.audit_md5_metadata_tbl AS a
	      ON m.schema_name = a.schema_name
	     AND m.object_type = a.object_type
	     AND m.object_type_name = a.object_type_name
	     AND COALESCE(m.object_subtype, '') = COALESCE(a.object_subtype, '')
	     AND COALESCE(m.object_subtype_name, '') = COALESCE(a.object_subtype_name, '')
	    WHERE a.object_md5 IS NULL;
	
	    --  Return only new snapshot deltas
	    RETURN QUERY
	    SELECT
	        m.snapshot_id,
	        m.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.prev_object_md5,
	        m.object_md5,
	        m.change_type
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    WHERE m.processed_time = v_snapshot.processed_time
	    ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name;
	
	END;
	$function$;
2025-11-05 22:20:21.791 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	;
2025-11-05 22:20:23.796 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 22:20:24.148 IST [54409] @ LOG:  checkpoint complete: wrote 4 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.323 s, sync=0.003 s, total=0.352 s; sync files=4, longest=0.002 s, average=0.001 s; distance=12 kB, estimate=176 kB; lsn=0/5D1FC088, redo lsn=0/5D1FC050
2025-11-05 22:20:27.616 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS TABLE (
	    snapshot_id TEXT,
	    processed_time TIMESTAMP,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    prev_object_md5 TEXT,
	    object_md5 TEXT,
	    change_type TEXT
	)
	LANGUAGE plpgsql
	AS $function$
	DECLARE
	    v_snapshot RECORD;
	BEGIN
	    --  Get the latest snapshot safely
	    SELECT s.snapshot_id, s.snapshot_process_time AS processed_time
	    INTO v_snapshot
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- ========================
	    -- 1 ADDED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        NULL AS prev_object_md5,
	        a.object_md5,
	        'ADDED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE m.object_md5 IS NULL;
	
	    -- ========================
	    -- 2 MODIFIED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        a.object_md5,
	        'MODIFIED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE a.object_md5 <> m.object_md5;
	
	    -- ========================
	    -- 3 DELETED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        NULL AS object_md5,
	        'DELETED'
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    LEFT JOIN pdcd_schema.audit_md5_metadata_tbl AS a
	      ON m.schema_name = a.schema_name
	     AND m.object_type = a.object_type
	     AND m.object_type_name = a.object_type_name
	     AND COALESCE(m.object_subtype, '') = COALESCE(a.object_subtype, '')
	     AND COALESCE(m.object_subtype_name, '') = COALESCE(a.object_subtype_name, '')
	    WHERE a.object_md5 IS NULL;
	
	    --  Return only new snapshot deltas
	    RETURN QUERY
	    SELECT
	        m.snapshot_id,
	        m.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.prev_object_md5,
	        m.object_md5,
	        m.change_type
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    WHERE m.processed_time = v_snapshot.processed_time
	    ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name;
	
	END;
	$function$;
2025-11-05 22:21:05.677 IST [52582] jagdish_pandre@test_db ERROR:  structure of query does not match function result type
2025-11-05 22:21:05.677 IST [52582] jagdish_pandre@test_db DETAIL:  Returned type integer does not match expected type text in column 1.
2025-11-05 22:21:05.677 IST [52582] jagdish_pandre@test_db CONTEXT:  SQL statement "SELECT
	        m.snapshot_id,
	        m.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.prev_object_md5,
	        m.object_md5,
	        m.change_type
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    WHERE m.processed_time = v_snapshot.processed_time
	    ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name"
	PL/pgSQL function pdcd_schema.load_changed_md5_metadata_tbl() line 98 at RETURN QUERY
2025-11-05 22:21:05.677 IST [52582] jagdish_pandre@test_db STATEMENT:  SELECT * FROM pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:22:13.180 IST [52582] jagdish_pandre@test_db LOG:  statement: DROP FUNCTION pdcd_schema.load_changed_md5_metadata_tbl();
2025-11-05 22:24:26.084 IST [52582] jagdish_pandre@test_db LOG:  statement: CREATE OR REPLACE FUNCTION pdcd_schema.load_changed_md5_metadata_tbl()
	RETURNS TABLE (
	    snapshot_id INTEGER,
	    processed_time TIMESTAMP,
	    schema_name TEXT,
	    object_type TEXT,
	    object_type_name TEXT,
	    object_subtype TEXT,
	    object_subtype_name TEXT,
	    object_subtype_details TEXT,
	    prev_object_md5 TEXT,
	    object_md5 TEXT,
	    change_type TEXT
	)
	LANGUAGE plpgsql
	AS $function$
	DECLARE
	    v_snapshot RECORD;
	BEGIN
	    --  Get the latest snapshot safely
	    SELECT s.snapshot_id, s.snapshot_process_time AS processed_time
	    INTO v_snapshot
	    FROM pdcd_schema.load_snapshot_tbl() AS s;
	
	    -- ========================
	    -- 1 ADDED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        NULL AS prev_object_md5,
	        a.object_md5,
	        'ADDED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    LEFT JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE m.object_md5 IS NULL;
	
	    -- ========================
	    -- 2 MODIFIED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        a.schema_name,
	        a.object_type,
	        a.object_type_name,
	        a.object_subtype,
	        a.object_subtype_name,
	        a.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        a.object_md5,
	        'MODIFIED'
	    FROM pdcd_schema.audit_md5_metadata_tbl AS a
	    JOIN pdcd_schema.md5_metadata_tbl AS m
	      ON a.schema_name = m.schema_name
	     AND a.object_type = m.object_type
	     AND a.object_type_name = m.object_type_name
	     AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	     AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	    WHERE a.object_md5 <> m.object_md5;
	
	    -- ========================
	    -- 3 DELETED records
	    -- ========================
	    INSERT INTO pdcd_schema.md5_metadata_tbl (
	        snapshot_id, processed_time, schema_name, object_type, object_type_name,
	        object_subtype, object_subtype_name, object_subtype_details,
	        prev_object_md5, object_md5, change_type
	    )
	    SELECT
	        v_snapshot.snapshot_id,
	        v_snapshot.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.object_md5 AS prev_object_md5,
	        NULL AS object_md5,
	        'DELETED'
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    LEFT JOIN pdcd_schema.audit_md5_metadata_tbl AS a
	      ON m.schema_name = a.schema_name
	     AND m.object_type = a.object_type
	     AND m.object_type_name = a.object_type_name
	     AND COALESCE(m.object_subtype, '') = COALESCE(a.object_subtype, '')
	     AND COALESCE(m.object_subtype_name, '') = COALESCE(a.object_subtype_name, '')
	    WHERE a.object_md5 IS NULL;
	
	    --  Return only new snapshot deltas
	    RETURN QUERY
	    SELECT
	        m.snapshot_id,
	        m.processed_time,
	        m.schema_name,
	        m.object_type,
	        m.object_type_name,
	        m.object_subtype,
	        m.object_subtype_name,
	        m.object_subtype_details,
	        m.prev_object_md5,
	        m.object_md5,
	        m.change_type
	    FROM pdcd_schema.md5_metadata_tbl AS m
	    WHERE m.processed_time = v_snapshot.processed_time
	    ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name;
	
	END;
	$function$;
2025-11-05 22:25:23.152 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 22:25:24.347 IST [54409] @ LOG:  checkpoint complete: wrote 12 buffers (0.1%); 0 WAL file(s) added, 0 removed, 0 recycled; write=1.170 s, sync=0.004 s, total=1.197 s; sync files=11, longest=0.002 s, average=0.001 s; distance=34 kB, estimate=161 kB; lsn=0/5D204930, redo lsn=0/5D2048F8
2025-11-05 22:32:21.466 IST [14825] jagdish_pandre@postgres LOG:  disconnection: session time: 1:00:10.255 user=jagdish_pandre database=postgres host=127.0.0.1 port=55410
2025-11-05 22:32:21.482 IST [14826] jagdish_pandre@postgres LOG:  disconnection: session time: 1:00:10.189 user=jagdish_pandre database=postgres host=127.0.0.1 port=55411
2025-11-05 22:32:21.497 IST [14828] jagdish_pandre@test_db LOG:  disconnection: session time: 1:00:09.974 user=jagdish_pandre database=test_db host=127.0.0.1 port=55412
2025-11-05 22:32:21.510 IST [14830] jagdish_pandre@test_db LOG:  disconnection: session time: 1:00:09.931 user=jagdish_pandre database=test_db host=127.0.0.1 port=55414
2025-11-05 22:32:21.521 IST [14832] jagdish_pandre@test_db LOG:  disconnection: session time: 1:00:09.811 user=jagdish_pandre database=test_db host=127.0.0.1 port=55416
2025-11-05 23:29:42.638 IST [52582] jagdish_pandre@test_db LOG:  statement: drop function pdcd_schema.load_changed_md5_metadata_tbl;
2025-11-05 23:30:10.732 IST [20727] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58011
2025-11-05 23:30:10.735 IST [20727] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 23:30:10.751 IST [20727] jagdish_pandre@postgres LOG:  disconnection: session time: 0:00:00.020 user=jagdish_pandre database=postgres host=127.0.0.1 port=58011
2025-11-05 23:30:10.754 IST [20728] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58012
2025-11-05 23:30:10.758 IST [20728] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 23:30:10.792 IST [20729] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58013
2025-11-05 23:30:10.795 IST [20729] jagdish_pandre@postgres LOG:  connection authorized: user=jagdish_pandre database=postgres
2025-11-05 23:30:10.909 IST [20730] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58014
2025-11-05 23:30:10.913 IST [20730] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 23:30:10.946 IST [20731] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58015
2025-11-05 23:30:10.949 IST [20731] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 23:31:19.074 IST [20804] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58090
2025-11-05 23:31:19.077 IST [20804] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 23:31:21.311 IST [20804] jagdish_pandre@test_db LOG:  disconnection: session time: 0:00:02.237 user=jagdish_pandre database=test_db host=127.0.0.1 port=58090
2025-11-05 23:31:29.614 IST [20816] [unknown]@[unknown] LOG:  connection received: host=127.0.0.1 port=58096
2025-11-05 23:31:29.618 IST [20816] jagdish_pandre@test_db LOG:  connection authorized: user=jagdish_pandre database=test_db
2025-11-05 23:31:32.510 IST [54409] @ LOG:  checkpoint starting: time
2025-11-05 23:31:32.864 IST [54409] @ LOG:  checkpoint complete: wrote 4 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.324 s, sync=0.003 s, total=0.355 s; sync files=4, longest=0.002 s, average=0.001 s; distance=8 kB, estimate=146 kB; lsn=0/5D206B20, redo lsn=0/5D206AE8
2025-11-05 23:40:11.412 IST [20816] jagdish_pandre@test_db ERROR:  column "p_table_list" does not exist at character 84
2025-11-05 23:40:11.412 IST [20816] jagdish_pandre@test_db STATEMENT:  With current_md5_metadata_cte as (
	        SELECT * FROM pdcd_schema.get_table_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(p_table_list)
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(p_table_list)
	)
	select * from current_md5_metadata_cte
2025-11-05 23:40:53.721 IST [20816] jagdish_pandre@test_db ERROR:  malformed array literal: "analytics_schema" at character 84
2025-11-05 23:40:53.721 IST [20816] jagdish_pandre@test_db DETAIL:  Array value must start with "{" or dimension information.
2025-11-05 23:40:53.721 IST [20816] jagdish_pandre@test_db STATEMENT:  With current_md5_metadata_cte as (
	        SELECT * FROM pdcd_schema.get_table_md5('analytics_schema')
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5('analytics_schema')
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5('analytics_schema')
	)
	select * from current_md5_metadata_cte
2025-11-05 23:41:20.374 IST [20816] jagdish_pandre@test_db ERROR:  syntax error at or near "'analytics_schema'" at character 195
2025-11-05 23:41:20.374 IST [20816] jagdish_pandre@test_db STATEMENT:  With current_md5_metadata_cte as (
	        SELECT * FROM pdcd_schema.get_table_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(array'analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(array'analytics_schema'])
	)
	select * from current_md5_metadata_cte
2025-11-05 23:44:27.793 IST [20816] jagdish_pandre@test_db ERROR:  column m.object_type_name does not exist at character 731
2025-11-05 23:44:27.793 IST [20816] jagdish_pandre@test_db HINT:  Perhaps you meant to reference the column "a.object_type_name".
2025-11-05 23:44:27.793 IST [20816] jagdish_pandre@test_db STATEMENT:  With current_md5_metadata_cte as (
	        SELECT * FROM pdcd_schema.get_table_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(array['analytics_schema'])
	)
	--select * from current_md5_metadata_cte;
	SELECT
	    a.schema_name,
	    a.object_type,
	    a.object_type_name,
	    a.object_subtype,
	    a.object_subtype_name,
	    a.object_subtype_details,
	    a.object_md5,
	    'ADDED' AS change_type
	FROM pdcd_schema.audit_md5_metadata_tbl a
	LEFT JOIN current_md5_metadata_cte m
	  ON a.schema_name = m.schema_name
	 AND a.object_type = m.object_type
	 AND a.object_type_name = m.object_type_name
	 AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	 AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	WHERE m.object_md5 IS NULL
	ORDER BY a.schema_name, a.object_type_name, a.object_subtype_name
2025-11-05 23:48:22.999 IST [20816] jagdish_pandre@test_db ERROR:  relation "current_md5_metadata_cte" does not exist at character 246
2025-11-05 23:48:22.999 IST [20816] jagdish_pandre@test_db STATEMENT:  SELECT
	    a.schema_name,
	    a.object_type,
	    a.object_type_name,
	    a.object_subtype,
	    a.object_subtype_name,
	    a.object_subtype_details,
	    a.object_md5,
	    'ADDED' AS change_type
	FROM pdcd_schema.audit_md5_metadata_tbl a
	LEFT JOIN current_md5_metadata_cte m
	  ON a.schema_name = m.schema_name
	 AND a.object_type = m.object_type
	 AND a.object_type_name = m.object_name
	 AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	 AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	WHERE m.object_md5 IS NULL
	ORDER BY a.schema_name, a.object_type_name, a.object_subtype_name
2025-11-05 23:50:20.737 IST [20816] jagdish_pandre@test_db ERROR:  relation "current_md5_metadata_cte" does not exist at character 246
2025-11-05 23:50:20.737 IST [20816] jagdish_pandre@test_db STATEMENT:  SELECT
	    a.schema_name,
	    a.object_type,
	    a.object_type_name,
	    a.object_subtype,
	    a.object_subtype_name,
	    a.object_subtype_details,
	    a.object_md5,
	    'ADDED' AS change_type
	FROM pdcd_schema.audit_md5_metadata_tbl a
	LEFT JOIN current_md5_metadata_cte m
	  ON a.schema_name = m.schema_name
	 AND a.object_type = m.object_type
	 AND a.object_type_name = m.object_name
	 AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	 AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	WHERE m.object_md5 IS NULL
	ORDER BY a.schema_name, a.object_type_name, a.object_subtype_name
2025-11-05 23:51:09.509 IST [20816] jagdish_pandre@test_db ERROR:  relation "current_md5_metadata_cte" does not exist at character 246
2025-11-05 23:51:09.509 IST [20816] jagdish_pandre@test_db STATEMENT:  SELECT
	    a.schema_name,
	    a.object_type,
	    a.object_type_name,
	    a.object_subtype,
	    a.object_subtype_name,
	    a.object_subtype_details,
	    a.object_md5,
	    'ADDED' AS change_type
	FROM pdcd_schema.audit_md5_metadata_tbl a
	LEFT JOIN current_md5_metadata_cte m
	  ON a.schema_name = m.schema_name
	 AND a.object_type = m.object_type
	 AND a.object_type_name = m.object_name
	 AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	 AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	WHERE m.object_md5 IS NULL
	ORDER BY a.schema_name, a.object_type_name, a.object_subtype_name
2025-11-05 23:59:18.380 IST [20816] jagdish_pandre@test_db ERROR:  syntax error at or near "FROM" at character 564
2025-11-05 23:59:18.380 IST [20816] jagdish_pandre@test_db STATEMENT:  With current_md5_metadata_cte as (
	        SELECT * FROM pdcd_schema.get_table_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(array['analytics_schema'])
	)
	SELECT
	    m.schema_name,
	    m.object_type,
	    m.object_name as object_subtype_name,
	    m.object_subtype,
	    m.object_subtype_name,
	    m.object_subtype_details,
	    m.object_md5,
	    'ADDED' AS change_type
	from current_md5_metadata_cte m
	FROM pdcd_schema.audit_md5_metadata_tbl a
	LEFT JOIN current_md5_metadata_cte m
	  ON a.schema_name = m.schema_name
	 AND a.object_type = m.object_type
	 AND a.object_type_name = m.object_name
	 AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	 AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	WHERE a.object_md5 IS NULL
	ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name
2025-11-05 23:59:24.368 IST [20816] jagdish_pandre@test_db ERROR:  table name "m" specified more than once
2025-11-05 23:59:24.368 IST [20816] jagdish_pandre@test_db STATEMENT:  With current_md5_metadata_cte as (
	        SELECT * FROM pdcd_schema.get_table_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(array['analytics_schema'])
	)
	SELECT
	    m.schema_name,
	    m.object_type,
	    m.object_name as object_subtype_name,
	    m.object_subtype,
	    m.object_subtype_name,
	    m.object_subtype_details,
	    m.object_md5,
	    'ADDED' AS change_type
	from current_md5_metadata_cte m
	LEFT JOIN current_md5_metadata_cte m
	  ON a.schema_name = m.schema_name
	 AND a.object_type = m.object_type
	 AND a.object_type_name = m.object_name
	 AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	 AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	WHERE a.object_md5 IS NULL
	ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name
2025-11-05 23:59:41.167 IST [20816] jagdish_pandre@test_db ERROR:  table name "m" specified more than once
2025-11-05 23:59:41.167 IST [20816] jagdish_pandre@test_db STATEMENT:  With current_md5_metadata_cte as (
	        SELECT * FROM pdcd_schema.get_table_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(array['analytics_schema'])
	)
	SELECT
	    m.schema_name,
	    m.object_type,
	    m.object_name as object_subtype_name,
	    m.object_subtype,
	    m.object_subtype_name,
	    m.object_subtype_details,
	    m.object_md5,
	    'ADDED' AS change_type
	from current_md5_metadata_cte m
	LEFT JOIN audit_md5_metadata_tbl m
	  ON a.schema_name = m.schema_name
	 AND a.object_type = m.object_type
	 AND a.object_type_name = m.object_name
	 AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	 AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	WHERE a.object_md5 IS NULL
	ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name
2025-11-05 23:59:48.077 IST [20816] jagdish_pandre@test_db ERROR:  column m.object_type_name does not exist at character 908
2025-11-05 23:59:48.077 IST [20816] jagdish_pandre@test_db HINT:  Perhaps you meant to reference the column "a.object_type_name".
2025-11-05 23:59:48.077 IST [20816] jagdish_pandre@test_db STATEMENT:  With current_md5_metadata_cte as (
	        SELECT * FROM pdcd_schema.get_table_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_all_columns_md5(array['analytics_schema'])
	        UNION ALL 
	        SELECT * FROM pdcd_schema.get_table_columns_md5(array['analytics_schema'])
	)
	SELECT
	    m.schema_name,
	    m.object_type,
	    m.object_name as object_subtype_name,
	    m.object_subtype,
	    m.object_subtype_name,
	    m.object_subtype_details,
	    m.object_md5,
	    'ADDED' AS change_type
	from current_md5_metadata_cte m
	LEFT JOIN audit_md5_metadata_tbl a
	  ON a.schema_name = m.schema_name
	 AND a.object_type = m.object_type
	 AND a.object_type_name = m.object_name
	 AND COALESCE(a.object_subtype, '') = COALESCE(m.object_subtype, '')
	 AND COALESCE(a.object_subtype_name, '') = COALESCE(m.object_subtype_name, '')
	WHERE a.object_md5 IS NULL
	ORDER BY m.schema_name, m.object_type_name, m.object_subtype_name
